---
title: 适用于 Blob 的热、冷、存档访问层 - Azure 存储
description: Azure 存储帐户的热、冷、存档访问层。
services: storage
author: mhopkins-msft
ms.service: storage
ms.topic: conceptual
ms.date: 03/23/2019
ms.author: mhopkins
ms.subservice: blobs
ms.openlocfilehash: 9be62e09fbf65081f166c89f5358cdb6677c22c6
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "61426794"
---
# <a name="azure-blob-storage-hot-cool-and-archive-access-tiers"></a>Azure Blob 存储：热、冷、存档访问层

Azure 存储提供了不同的访问层，允许以最具成本效益的方式存储 Blob 对象数据。 可用的访问层包括：

- **热**：适用于存储经常访问的数据。
- **冷**：适用于存储不常访问且存储时间至少为 30 天的数据。
- **存档**：适用于存储极少访问、存储时间至少为 180 天且延迟要求（以小时计）不严格的数据。

以下注意事项适用于不同的访问层：

- 存档访问层仅在 Blob 级别提供，在存储帐户级别不提供。
- 冷访问层中的数据可容许略低的可用性，但仍需要像热数据一样的高持续性和类似的访问时间以及吞吐量特征。 对于冷数据，略低的可用性服务级别协议 (SLA) 和较高的访问成本（与热数据相比）对于更低的存储成本而言是可接受的折衷。
- 封存儲存體已離線並提供最低的儲存成本，但存取成本最高。
- 在帐户级别只能设置热和冷访问层。
- 可在对象级别设置热、冷和存档层。

儲存在雲端的資料迅速成長。 若要為不斷擴充的儲存體需求來管理成本，根據存取頻率和計劃性保留期來組織您的資料，進而將成本最佳化很有幫助。 存储在云中的数据在其生成方式、处理方式以及在生存期内的访问方式等方面会不相同。 有些資料在其存留期內會積極地存取及修改。 有些資料在其存留期的早期存取頻率很高，但存取頻率隨著資料老化而大幅下滑。 某些数据在云中保持空闲状态，并且在存储后很少（如果有）被访问。

这些数据访问方案的每一个都受益于针对特定访问模式进行了优化的差异化访问层。 Azure Blob 存储采用热、冷、存档访问层，通过单独的定价模型来满足对差异化访问层的这种需要。

## <a name="storage-accounts-that-support-tiering"></a>支援階層處理的儲存體帳戶

在 Blob 存储或常规用途 v2 (GPv2) 帐户中，只能将对象存储数据分到热层、冷层或存档层。 一般用途 v1 (GPv1) 帳戶不支援階層處理。 不过，可以轻松地将现有的 GPv1 或 Blob 存储帐户转换为 GPv2 帐户，只需在 Azure 门户中单击一下即可。 GPv2 为 Blob、文件和队列提供新的定价结构，可以访问各种其他的全新存储功能。 以后只对 GPv2 帐户提供某些新功能和价格折扣。 因此，应使用 GPv2 帐户进行评估，但只应在查看所有服务的定价以后再使用此类帐户。 某些工作负荷的价格在 GPv2 中可能比在 GPv1 中更高。 如需詳細資訊，請參閱 [Azure 儲存體帳戶概觀](../common/storage-account-overview.md)。

Blob 存储和 GPv2 帐户在帐户级别公开“访问层”属性。 此属性可方便你将存储帐户中任何 Blob 的默认访问层指定为热层或冷层，前提是该 Blob 尚未在对象级别设置显式层。 對於已在物件層級設定儲存層的物件，不會套用此帳戶層。 存档层仅适用于对象级别。 可以随时在这些访问层之间进行切换。

## <a name="premium-performance-block-blob-storage"></a>Premium 效能區塊 blob 儲存體

Premium 效能區塊 blob 儲存體可讓您可透過高效能硬體經常存取的資料。 此效能層級中的資料會儲存在固態硬碟 (Ssd)，這針對低且一致的延遲進行最佳化。 Ssd 提供更高的交易速率和相較於傳統的硬碟機的輸送量。

Premium 效能區塊 blob 儲存體適合需要快速且一致的回應時間的工作負載。 它是最適合執行許多小型交易的詳細資訊，例如擷取遙測資料、 訊息和資料轉換的工作負載。 牽涉到使用者項目，例如互動式視訊編輯、 靜態 web 內容，以及線上交易的資料也是很好的候選項目。

Premium 效能區塊 blob 儲存體只能透過區塊 blob 儲存體帳戶類型，且目前不支援經常性存取、 非經常性存取或封存存取層級階層處理。

## <a name="hot-access-tier"></a>經常性存取層

热访问层的存储成本高于冷存储和存档层，但访问成本最低。 热访问层的示例使用方案包括：

- 处于活跃使用状态或预期会频繁访问（读取和写入）的数据。
- 分阶段进行处理，并最终迁移至冷访问层的数据。

## <a name="cool-access-tier"></a>非經常性存取層

与热存储相比，冷访问层的存储成本较低，访问成本较高。 這一層適用於將保留在非經常性存取層至少 30 天的資料。 冷访问层的示例使用方案包括：

- 短期備份和災害復原資料集。
- 不再經常檢視，但存取時應立即可用的較舊媒體內容。
- 當收集較多資料以供未來處理時，需要以符合成本效益方式預存的大型資料集。 (例如，科學資料、來自製造工廠的原始遙測資料等長期儲存)

## <a name="archive-access-tier"></a>封存存取層

与热层和冷层相比，存档访问层的存储成本最低，但数据检索成本较高。 這一層適用於可承受擷取延遲數個小時，而且將保留在封存層中至少 180 天的資料。

如果 Blob 位于存档存储中，则 Blob 数据处于脱机状态，不能读取、复制、覆盖或修改。 不能创建存档存储中 Blob 的快照。 不過，Blob 中繼資料會保持連線且可以取得，讓您可列出 Blob 和其屬性。 对于存档中的 Blob，仅以下操作有效：GetBlobProperties、GetBlobMetadata、ListBlobs、SetBlobTier 和 DeleteBlob。

存档访问层的示例使用方案包括：

- 長期備份、次要備份和封存資料集
- 即使已處理成最終可用格式，但還是需要保存的原始資料。 (例如，轉碼成其他格式之後的原始媒體檔案)
- 需要儲存一段時間且幾乎不曾存取的相容性和封存資料。 （例如，安全监控录像、医保组织的旧 X 光/MRI 资料、音频记录、金融服务机构的客户呼叫记录）

### <a name="blob-rehydration"></a>Blob 解除凍結

若要閱讀封存儲存體中的資料，您必須先將 blob 層變更為經常性存取或非經常性存取。 此程序稱為解除凍結，最多可能需要 15 小時才能完成。 為了達到最佳效能，建議使用大型 Blob。 同時解除凍結數個小型 blob 可能會增加額外時間。

在解除凍結期間，您可以查看 [封存狀態] blob 屬性，以確認是儲存層否已變更。 視目的地層而定，狀態會顯示為 "rehydrate-pending-to-hot" 或 "rehydrate-pending-to-cool"。 完成時，系統會移除封存狀態屬性，而 [存取層] blob 屬性會反映新的經常性存取或非經常性存取層。  

## <a name="blob-level-tiering"></a>Blob 層級的階層處理

Blob 層級的階層處理可讓您使用稱為[設定 Blob 層](/rest/api/storageservices/set-blob-tier)的單一作業，在物件層級變更您的資料層。 您可以隨著使用模式變更，在經常性存取、非經常性存取或封存層之間輕鬆地變更 blob 的存取層，而不必在帳戶之間移動資料。 所有的存取層變更都會立即發生。 但是，從封存解除凍結 Blob 可能需要數小時的時間。

最後一個 blob 層變更的時間會透過 [存取層變更時間] blob 屬性公開。 如果 Blob 位于存档层中，则无法被覆盖，因此在这种情况下，不允许上传相同的 Blob。 可以覆盖热层和冷层中的 Blob，在这种情况下，新的 Blob 会继承被覆盖的 Blob 的层。

所有三个访问层中的 Blob 可以在同一帐户中共存。 若 blob 未明確指派任何階層，則系統會從帳戶存取層的設定加以推斷。 如果存取層是從帳戶推斷而來，您會看到 [推斷的存取層] blob 屬性設定為 "true"，而且 blob [存取層] blob 屬性符合帳戶層。 在 Azure 门户中，推断属性的访问层与 Blob 访问层（例如，热（推断）或冷（推断））一起显示。

> [!NOTE]
> 封存儲存體與 Blob 層級階層處理只支援區塊 blob。 您也無法變更具有快照集之區塊 blob 的存取層。

> [!NOTE]
> 區塊 blob 儲存體帳戶中儲存的資料目前無法經常性存取、 非經常性存取或封存使用分層[設定 Blob 層](/rest/api/storageservices/set-blob-tier)或使用 Azure Blob 儲存體生命週期管理。
> 若要移動資料，您必須以同步方式複製 blob 的區塊 blob 儲存體帳戶中不同的帳戶，使用經常性存取層[放置區塊從 URL API](/rest/api/storageservices/put-block-from-url)或版本的 AzCopy 支援此 API。
> *Put Block From URL* API 會同步複製伺服器上的資料，這表示只有將所有資料從原始伺服器位置移動到目標位置後，才會完成呼叫。

### <a name="blob-lifecycle-management"></a>Blob 生命週期管理

Blob 儲存體生命週期管理提供了豐富、 以規則為基礎的原則，您可以使用轉換您的資料，最佳的存取層，並讓其生命週期結尾的資料過期。 若要深入了解，請參閱[管理 Azure Blob 儲存體生命週期](storage-lifecycle-management-concepts.md)。  

### <a name="blob-level-tiering-billing"></a>Blob 層級的階層處理計費

當 Blob 移至存取頻率較低的階層 (經常性存取 -> 非經常性存取、經常性存取 -> 封存，或非經常性存取 -> 封存) 時，此作業會在寫入目的地階層時計費，且適用目的地階層的寫入作業 (每 10,000 個) 和資料寫入 (每 GB) 費用。

将 Blob 移到更暖的层（存档->冷、存档->热或冷->热）时，操作按从源层读取计费，具体说来就是按源层的读取操作次数（以 10,000 次为单位）和数据检索量（以 GB 为单位）收费。 下表摘要說明層級變更的計費方式：

| | **寫入費用 (作業 + 存取)** | **讀取費用 (作業 + 存取)**
| ---- | ----- | ----- |
| **SetBlobTier 方向** | 热->冷、热->存档、冷->存档 | 存档->冷、存档->热、冷->热

如果帳戶層從經常性存取切換至非經常性存取，您需針對在 GPv2 帳戶中未設定存取層的所有 blob 支付寫入作業費用 (每 10,000 個)。 此變更在 Blob 儲存體帳戶中不收費。 如果您將 Blob 儲存體或 GPv2 帳戶從非經常性存取切換至經常性存取，您需支付讀取作業 (每 10,000 個) 和資料擷取 (每 GB) 費用。 可能也適用任何移出非經常性存取或封存層之 blob 的提早刪除費用。

### <a name="cool-and-archive-early-deletion"></a>非經常性存取和封存提前刪除

除了每 GB、每月費用，任何移入非經常性存取層 (僅限 GPv2 帳戶) 的 blob 都受制於 30 天的非經常性存取提早刪除期間，而且任何移入封存層的 blob 都受制於 180 天的封存提早刪除期間。 此費用按比例計算。 例如，如果 blob 移至封存，然後在 45 天後遭到刪除或移至經常倖存取層，您需支付相當於在封存中儲存該 blob 135 (180 減去 45) 天的提早刪除費用。

如果沒有存取層變更，您可以使用 Blob 屬性 **creation-time** 來計算提前刪除。 否则，可以通过查看 Blob 属性（即“access-tier-change-time”）来使用最后一次将访问层修改为“冷”或“存档”的时间。 如需 Blob 屬性的詳細資訊，請參閱[取得 Blob 屬性](https://docs.microsoft.com/rest/api/storageservices/get-blob-properties)。

## <a name="comparing-block-blob-storage-options"></a>比较块 Blob 存储选项

下表所示的進階效能區塊 blob 儲存體，並且為作用比較、 非經常性與封存存取層。

|                                           | **Premium 效能** | **經常性存取層** | **非經常性存取層** | **封存層**
| ----------------------------------------- | ---------------- | ------------ | ----- | ----- |
| **可用性**                          | 99.9%            | 99.9%        | 99% | N/A |
| **可用性** <br> **(RA-GRS 讀取)**  | N/A              | 99.99%       | 99.9% | N/A |
| **使用費用**                         | 較高的儲存體成本、 較低的存取和交易成本 | 儲存成本較高，存取和交易成本較低 | 儲存成本較低，存取和交易成本較高 | 儲存成本最低，存取和交易成本最高 |
| **最小物件大小**                   | N/A | N/A | N/A | N/A |
| **最小儲存持續時間**              | N/A | N/A | 30 天 (僅限 GPv2) | 180 天
| **延遲** <br> **(距第一位元組時間)** | 單一位數 （毫秒) | 毫秒 | 毫秒 | < 15 小時

> [!NOTE]
> 延展性和效能目標，請參閱[儲存體帳戶的 Azure 儲存體延展性和效能目標](../common/storage-scalability-targets.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)

## <a name="quickstart-scenarios"></a>快速入門案例

在這一節中，我們會使用 Azure 入口網站示範下列案例︰

- 如何變更 GPv2 或 Blob 儲存體帳戶的預設帳戶存取層。
- 如何在 GPv2 或 Blob 儲存體帳戶中變更 Blob 的存取層。

### <a name="change-the-default-account-access-tier-of-a-gpv2-or-blob-storage-account"></a>變更 GPv2 或 Blob 儲存體帳戶的預設帳戶存取層

1. 登入 [Azure 入口網站](https://portal.azure.com)。

1. 瀏覽至儲存體帳戶、選取 [所有資源]，然後選取您的儲存體帳戶。

1. 在 [設定] 刀鋒視窗中按一下 [組態]  ，以檢視和/或變更帳戶組態。

1. 根据需求选择合适的访问层：將 [存取層] 設定為 [非經常性存取] 或 [經常性存取]。

1. 按一下刀鋒視窗頂端的 [儲存] 。

### <a name="change-the-tier-of-a-blob-in-a-gpv2-or-blob-storage-account"></a>更改 GPv2 或 Blob 存储帐户中 Blob 的层

1. 登入 [Azure 入口網站](https://portal.azure.com)。

1. 若要导航到存储帐户中的 Blob：请依次选择“所有资源”、存储帐户、容器、Blob。

1. 在“Blob 属性”边栏选项卡中选择“访问层”下拉菜单，选择“热”、“冷”或“存档”访问层。

1. 按一下刀鋒視窗頂端的 [儲存] 。

## <a name="pricing-and-billing"></a>價格和計費

所有儲存體帳戶會對以每個 Blob 層為基礎的 Blob 儲存體使用價格模型。 請注意下列計費考量：

- **儲存成本**：除了存储的数据量，存储数据的成本将因访问层而异。 每 GB 的成本會隨著儲存層存取頻率降低而減少。
- **資料存取成本**：資料存取費用會隨著儲存層存取頻率降低而增加。 对于冷访问层和存档访问层中的数据，需要按 GB 支付读取方面的数据访问费用。
- **交易成本**：所有層都有每筆交易的費用，該費用會隨著儲存層存取頻率降低而增加。
- **異地複寫資料傳輸成本**：此費用適用於已設定異地複寫的帳戶，包括 GRS 和 RA-GRS。 異地複寫資料傳輸會產生每 GB 費用。
- **輸出資料傳輸成本**：輸出資料傳輸 (從 Azure 區域傳出的資料) 會產生每 GB 頻寬使用量費用，與一般用途的儲存體帳戶一致。
- **更改访问层**：将帐户访问层从“冷”更改为“热”会产生费用，费用等于读取存储帐户中存在的所有数据的费用。 不過，將帳戶存取層從經常性存取層變更為非經常性存取層，會產生相當於將所有資料寫入非經常性存取層的費用 (僅限 GPv2 帳戶)。

> [!NOTE]
> 如需 Blob 儲存體帳戶的定價詳細資訊，請參閱 [Azure 儲存體定價](https://azure.microsoft.com/pricing/details/storage/)頁面。 如需輸出資料傳輸費用的詳細資訊，請參閱[資料傳輸定價詳細資料](https://azure.microsoft.com/pricing/details/data-transfers/)頁面。

## <a name="faq"></a>常見問題集

**如果我想要將我的資料進行階層處理，應使用 Blob 儲存體或 GPv2 帳戶？**

建議您 GPv2，而不要使用 Blob 儲存體帳戶進行階層處理。 GPv2 支援 Blob 儲存體帳戶支援的所有功能，以及其他許多功能。 Blob 儲存體與 GPv2 之間的價格幾乎相同，但是 GPv2 帳戶將提供一些新功能和降價。 GPv1 帳戶不支援階層處理。

GPv1 與 GPv2 帳戶之間的價格結構不同，客戶在決定使用 GPv2 帳戶之前，應該仔細評估兩者。 您可以透過簡單的單鍵程序，輕鬆地將現有的 Blob 儲存體或 GPv1 帳戶轉換為 GPv2。 如需詳細資訊，請參閱 [Azure 儲存體帳戶概觀](../common/storage-account-overview.md)。

**可以儲存物件中的三個 （經常性存取、 非經常性存取和封存） 存取相同帳戶中的層級嗎？**

是。 設定於帳戶層級的 [存取層] 屬性是套用至該帳戶中所有物件的預設層 (沒有明確設定的層)。 不過，blob 層級的階層處理功能可讓您在物件層級上設定存取層，而不管帳戶上設定的存取層為何。 这三个访问层（热、冷或存档）中任何一层的 Blob 都可以存在于同一帐户中。

**我可以變更 GPv2 或 Blob 儲存體帳戶的預設存取層？**

是的，可以通过设置存储帐户上的“访问层”属性来更改默认访问层。 更改访问层适用于存储在帐户中的所有对象，前提是该帐户没有显式设置层。 将访问层从热切换为冷只对 GPv2 帐户中没有设置层的所有 Blob 产生写入操作次数（以 10,000 次为单位）收费，而从冷切换为热则会对 Blob 存储和 GPv2 帐户中的所有 Blob 产生读取操作次数（以 10,000 次为单位）和数据检索量（以 GB 为单位）收费。

**是否可以將我的預設帳戶存取層設定為封存？**

沒有。 只能将默认帐户访问层设置为热访问层或冷访问层。 封存只能設定於物件層級。

**所在區域是經常性、 非經常性存取和封存存取層中可用？**

所有区域均提供热访问层和冷访问层以及 Blob 级别的分层。 封存儲存體一開始只在精選區域中提供。 如需完整清單，請參閱 [Azure 依區域提供的產品](https://azure.microsoft.com/regions/services/)。

**非經常性存取層中的 blob 行為與經常性存取層中的不同？**

热访问层中 Blob 的延迟与 GPv1、GPv2 和 Blob 存储帐户中 Blob 的延迟相同。 冷访问层中 Blob 的延迟（以毫秒为单位）与 GPv1、GPv2 和 Blob 存储帐户中 Blob 的延迟类似。 存档访问层中的 Blob 在 GPv1、GPv2 和 Blob 存储帐户中有数小时的延迟。

冷访问层中的 Blob 具有的可用性服务级别 (SLA) 比存储在热访问层中的 Blob 略低。 如需詳細資訊，請參閱[儲存體 SLA](https://azure.microsoft.com/support/legal/sla/storage/v1_2/)。

**經常性存取、非經常性存取和封存層之間的作業是否相同？**

是。 經常性存取與非經常性存取之間的所有作業都完全一致。 經常性存取與非經常性存取的所有有效封存作業 (包括刪除、列出、取得 blob 屬性/中繼資料，以及設定 blob 層) 都完全一致。 無法讀取或修改封存層中的 blob。

**將 Blob 從封存層解凍至經常性存取或非經常性存取層時，我要如何知道解除凍結已完成？**

在解除凍結期間，您可以使用「取得 blob 屬性」作業來輪詢 [封存狀態] 屬性，以確認存取層變更何時完成。 視目的地層而定，狀態會顯示為 "rehydrate-pending-to-hot" 或 "rehydrate-pending-to-cool"。 完成時，系統會移除封存狀態屬性，而 [存取層] blob 屬性會反映新的經常性存取或非經常性存取層。  

**設定 blob 的存取層之後，何時會開始以適當的費率計費？**

每個 Blob 一律根據 Blob [存取層] 屬性所指定的存取層計費。 當您為為 Blob 設定新存取層時，[存取層] 屬性會立即反映所有轉換的新存取層。 不過，將封存層的 Blob 解除凍結至經常性存取或非經常性存取層可能需要數小時的時間。 在此情況下，您會以封存費率計費，直到解除凍結完成為止，[存取層] 屬性會反映新的存取層。 屆時，您會以經常性存取或非經常性存取費率，為該 Blob 付費。

**如何判斷在刪除 blob 或將它移出非經常性存取或封存層時，我是否需支付提早刪除費用？**

在 30 天前和 180 天前遭到刪除或移出非經常性存取 (僅限 GPv2 帳戶) 或封存層的任何 Blob，分別會產生按比例計算的提早刪除費用。 檢查 [存取層變更時間] Blob 屬性 (該屬性提供最後一次存取層變更的戳記)，即可判斷 Blob 放在非經常性存取或封存層中的時間長度。 有关详细信息，请参阅[冷层和存档层的早期删除](#cool-and-archive-early-deletion)。

**哪些 Azure 工具和 SDK 支援 blob 層級的階層處理和封存儲存體？**

Azure 入口網站、PowerShell 和 CLI 工具，以及 .NET、Java、Python 和 Node.js 用戶端程式庫全都支援 blob 層級的階層處理和封存儲存體。  

**我可以在經常性存取、非經常性存取和封存層中儲存多少資料？**

数据存储和其他限制在帐户级别设置，不是按访问层设置。 因此，您可以選擇在其中一層或在全部三個層中使用所有限制。 如需詳細資訊，請參閱 [Azure 儲存體延展性和效能目標](../common/storage-scalability-targets.md?toc=%2fazure%2fstorage%2fblobs%2ftoc.json)。

## <a name="next-steps"></a>後續步驟

### <a name="evaluate-hot-cool-and-archive-in-gpv2-blob-storage-accounts"></a>在 GPv2 Blob 儲存體帳戶中評估經常性存取、非經常性存取和封存

[依照區域檢查經常性存取、非經常性存取和封存的可用性](https://azure.microsoft.com/regions/#services)

[管理 Azure Blob 儲存體生命週期](storage-lifecycle-management-concepts.md)

[啟用 Azure 儲存體計量以評估您目前的儲存體帳戶使用量](../common/storage-enable-and-view-metrics.md)

[依照區域檢查 Blob 儲存體和 GPv2 帳戶中的經常性存取、非經常性存取和封存價格](https://azure.microsoft.com/pricing/details/storage/)

[檢查資料傳輸價格](https://azure.microsoft.com/pricing/details/data-transfers/)
