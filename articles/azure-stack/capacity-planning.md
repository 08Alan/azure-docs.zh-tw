---
title: Azure Stack 的容量規劃 | Microsoft Docs
description: 了解 Azure Stack 部署的容量規劃。
services: azure-stack
documentationcenter: ''
author: jeffgilb
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/12/2019
ms.author: jeffgilb
ms.reviewer: prchint
ms.lastreviewed: 09/18/2018
ms.openlocfilehash: b8bd57953845278aa75e8cbdf41ae28300edad58
ms.sourcegitcommit: 301128ea7d883d432720c64238b0d28ebe9aed59
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/13/2019
ms.locfileid: "56184902"
---
# <a name="azure-stack-capacity-planning"></a>Azure Stack 容量規劃
評估 Azure Stack 解決方案時，可以選擇硬體組態，因為這直接影響到 Azure Stack 雲端的整體容量。 其中包括 CPU、記憶體密度、儲存體組態和整體解決方案規模或伺服器的數目等典型選項。 不同於傳統的虛擬化解決方案，簡單地計算這些元件不適用於決定可用的容量。 其第一個原因是 Azure Stack 的架構是解決方案本身就裝載基礎結構或管理元件。 第二個原因是解決方案的部分容量會為支援恢復功能而保留；透過將租用戶工作負載中斷情形降到最低的方式，來更新解決方案的軟體。

> [!IMPORTANT]
> 所提供的容量規劃資訊以及隨附的試算表僅供參考，協助您決定 Azure Stack 的規劃和設定作業， 並非用以取代您自己的調查與分析。 

## <a name="compute-and-storage-capacity-planning"></a>計算和儲存體容量規劃
Azure Stack 是以計算、網路和儲存體的超融合式叢集的形式建立的解決方案。 如此能以提供可用性和延展性的方式，有效運用或共用叢集中所有的硬體容量 (Azure Stack 稱為縮放單位)。 所有基礎結構軟體均託管在一組虛擬機器 (VM) 中，並且和租用戶 VM 共用相同的實體伺服器。 所有 VM 都會受控於縮放單位的 Windows Server 叢集技術和個別 Hyper-V 執行個體。 此方法可以簡化 Azure Stack 解決方案的取得和管理作業，並可移動整個縮放單位的所有服務 (租用戶和基礎結構) 並提供延展性。

伺服器記憶體是 Azure Stack 解決方案中唯一未過度佈建的實體資源。 其他資源、 CPU 核心、 網路頻寬及儲存體容量都會過度佈建，以有效運用可用資源。 計算方案的可用容量時，實體伺服器記憶體為主要的考量因素。 再來會透過其他資源的使用量得知過度部署可達到的比例，以及預期工作負載可接受的程度。

大約會使用 28 部 VM 來託管 Azure Stack 基礎結構，總計耗用約 208 GB 的記憶體和 124 個虛擬核心。  使用這個數量 VM 的根本原因，是為了因應所需的服務區隔，以滿足安全性、延展性、維護及修補上的需求。 此內部服務結構可在未來研發出新的基礎結構服務時引入該服務。

為了支援所有實體伺服器和基礎結構軟體元件的自動更新，或是為了修補和更新，基礎結構和使用者 VM 的放置不會耗用到縮放單位的所有記憶體資源。 為了支援解決方案的復原需求，會取消配置縮放單位所有伺服器的總記憶體量。 例如，在更新實體伺服器的 Windows Server 映像時，當伺服器的 Windows Server 映像在進行更新，託管在伺服器上的 VM 就會移到縮放單位內的其他位置。 更新完成後，伺服器會重新啟動，並返回處理工作負載。 修補和更新 Azure Stack 解決方案的目的，是為了發生需要停止託管 VM 的情況。 為了盡力達到此目的，至少會留下一部伺服器的記憶體容量不加以配置，以讓縮放單位內的 VM 可以移動。 此設置和移動樣適用於基礎結構 VM 以及代表使用者或 Azure Stack 解決方案租用戶建立的 VM。 最終實作結果是，當 VM 的記憶體需求有所差異時，由於 VM 的放置有其難處，為了支援 VM 移動的需求，保留的記憶體數量可能遠遠超過單一伺服器的容量。 記憶體使用類別中的額外負荷，便是 Windows Server 執行個體本身的負荷。 每一部伺服器的基礎作業系統執行個體會耗用作業系統及其虛擬分頁表的記憶體，以及管理每個託管 VM 時 Hyper-V 使用的記憶體。

本節稍後會進一步說明容量計算的複雜度。 本簡介提供下列範例，協助您了解不同解決方案大小的可用容量。 這些均為估計值，因此僅是對租用戶 VM 記憶體的用量假設，可能並不等同生產安裝環境下的實際情況。 此資料表使用的是標準 D2 Azure VM 大小。 標準 Azure D2 VM 的定義是具有 2 個虛擬 CPU 和 7 GB 記憶體。

|     |每個伺服器容量|| 縮放單位容量|  |  |||
|-----|-----|-----|-----|-----|-----|-----|-----|
|     | 記憶體 | CPU 核心 | 伺服器數目 | 記憶體 | CPU 核心 | 租用戶 VM<sup>1</sup>     | 核心比率<sup>2</sup>    |
|範例 1|256 GB|28|4|1024 GB| 112 | 54 |4:3|
|範例 2|512 GB|28|4|2024 GB|112|144|4:1|
|範例 3|384 GB|28|12|4608 GB|336|432|3:1|
|     |     |     |     |     |     |     |     |

> <sup>1</sup> 標準 D2 VM。

> <sup>2</sup> 虛擬核心與實體核心比率。

如先前所述，VM 容量取決於可用的記憶體。 虛擬核心與實體核心比率，顯現出了 VM 密度會如何改變 CPU 可用容量的例子，除非所建構的解決方案擁有較多的實體核心 (選擇了另一個 CPU)。 儲存體容量和儲存體快取容量也是如此。

上述範例中的 VM 密度僅供說明之用。 在支援計算時會更加複雜。 如需進一步了解容量規劃選擇和產生的可用容量，請聯絡 Microsoft 或解決方案合作夥伴。

本節其餘部分會說明部署 Azure Stack 時計算和儲存體方面的需求。 您可透過此資訊概略了解需要哪些元件以及元件的最小設定值。 另外也會提供相關資訊，說明如何根據可用容量和系統對租用戶容量和效能功能方面的潛在限制來設定解決方案。

> [!NOTE]
> 因為只能設定公用 VIP 的大小，網路方面的容量規劃需求很少。 如需如何將更多公用 IP 位址新增到 Azure Stack 的相關資訊，請參閱[新增公用 IP 位址](azure-stack-add-ips.md)。


## <a name="next-steps"></a>後續步驟
[計算容量規劃](capacity-planning-compute.md)
