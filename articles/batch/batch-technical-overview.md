<properties
	pageTitle="Azure 批次技術概觀"
	description="了解 Azure 批次服務的概念、工作流程及案例"
	services="batch"
	documentationCenter=""
	authors="dlepow"
	manager="timlt"
	editor=""/>

<tags
	ms.service="batch"
	ms.workload="big-compute"
	ms.tgt_pltfrm="na"
	ms.devlang="na"
	ms.topic="article"
	ms.date="04/28/2015"
	ms.author="danlep"/>


#Azure 批次技術概觀
Azure 的批次可協助您執行大規模運算 (HPC) 應用程式在雲端中的平行且高效能。它是平台服務，可提供工作排程和自動調整的受管理的虛擬機器 (Vm) 執行的工作集合。藉由使用批次服務，您可以設定批次的工作量，視需要或依排程，在 Azure 中執行，而不必擔心排程作業和管理 Vm 基礎平台的複雜性。

>[AZURE.NOTE]「批次」目前為預覽狀態。若要使用批次，您需要 Azure 帳戶，並需要登入，以批次預覽。如果您沒有帳戶，只需要幾分鐘的時間就可以建立免費試用帳戶。如需詳細資料，請參閱＜[建立 Azure 帳戶](http://azure.microsoft.com/develop/php/tutorials/create-a-windows-azure-account/)＞。


## 使用案例

批次使用的彈性和雲端的小數位數來協助您解決 *批次處理* 或 *批次運算* -執行大量的類似的工作，讓一些期望的結果。命令列程式或指令碼接受一組資料檔案做為輸入，以一系列的工作來處理資料，然後產生一組輸出檔。輸出檔可能是最後的結果或更大的工作流程中的一個中間步驟。

在依排程或隨需求而處理、轉換和分析大量資料的組織中，批次運算是一種常見的模式。其中包括循環終了的處理，例如銀行的每日風險報表，或必須準時完成的薪資表。也包括大型商業、科學和工程應用程式，通常需要運算叢集或網格的工具和資源。應用程式包括傳統的 HPC 應用程式，例如流體動力學模擬及特殊工作負載，像是汽車設計、石油和天然氣探勘、生命科學研究及數位內容創作等領域。

批次很適合處理本質上平行 (有時稱為「窘迫平行」) 的應用程式或工作負載，而這些本身就適合在多部電腦上以平行工作執行，例如批次服務所管理的計算 VM。請參閱 [圖 1]。

![平行工作][parallel]

**[圖 1。在多部電腦上執行的平行工作**

範例包括：

* 財務風險模型
* 影像轉譯和影像處理
* 媒體編碼及轉碼
* 基因序列分析
* 軟體測試

您也可以使用批次來執行平行計算 (最後加上歸納步驟)，以及其他更複雜的無循環性平行工作負載。

>[AZURE.NOTE]批次預覽目前不支援訊息傳遞介面 (MPI) 應用程式。

## 開發人員的案例

以 REST 為基礎的批次 API 支援兩種開發人員案例，可協助您利用批次服務來設定及執行批次工作負載：

1. **區別做為工作項目** -使用 *批次* Api 來建立和管理有彈性的集區的計算 Vm 並指定其執行的工作。這可讓您完整控制資源，而且需要用戶端來管理工作執行管線-例如，與工作流程管理員或中繼排程器，可以使用批次 REST Api 或選擇性工作管理員功能之工作項目的實作。您可以自動化排定計算作業，並相應擴大和縮小計算 VM 集區來執行這些作業，而不需設定計算叢集或撰寫程式碼將作業排入佇列和排定工作。在指定工作項目，您定義的所有相依性，並定義輸入和輸出檔案的移動。

2. **發行並執行應用程式與批次服務** - *批次的應用程式* Api 的運作是在較高層級，而幫助您包裝現有的應用程式，因此它會執行為背景的批次中受管理的集區的 Vm 上的服務。應用程式可能會執行用戶端工作站上的今天或計算叢集的其中一個。批次應用程式架構會處理輸入檔和輸出檔的移動、作業執行、作業管理，以及資料持續性。批次應用程式也可讓您模擬資料分割的工作，以及作業中多個步驟的工作。其中包含以 REST 為基礎的 API 和批次應用程式入口網站，這些都可以從 Azure 管理入口網站存取，並幫助您監視您提交的作業。


## 批次概念

下列各節摘要說明使用批次服務和 API 的重要概念。如需詳細資訊，請參閱 [Azure 批次的應用程式開發介面基本知識](batch-api-basics.md)。

* [批次帳戶](#BKMK_Account)
* [工作虛擬機器和集區](#BKMK_TVM)
* [工作項目、 工作和工作](#BKMK_Workitem)
* [檔案和目錄](#BKMK_Files)

### <a id="BKMK_Account">批次帳戶</a>
您需要的唯一 **批次帳戶** 使用批次服務。您對批次服務的所有要求必須使用帳戶的名稱以及其存取金鑰進行都驗證。

您可以建立批次帳戶及管理在 Azure 入口網站或使用帳戶存取金鑰 [批次 PowerShell cmdlet](batch-powershell-cmdlets-get-started.md)。

若要建立批次帳戶入口網站中：

1. 登入 [Azure 管理入口網站](https://manage.windowsazure.com)。
2. 按一下 **新增**, ，按一下 **計算**, ，按一下 **批次服務**, ，然後按一下 **快速建立**。 ![建立批次帳戶：][account_portal]

3. 輸入以下資訊：

	* 在 **帳戶名稱**, ，輸入在批次帳戶 URL 中使用的唯一名稱。
	* 在 **區域**, ，選取的區域，批次功能。
	* 如果您在有多個訂閱， **訂閱**, ，選取可用的訂閱，還是必須支付貴用戶使用批次。


### <a id="BKMK_TVM">工作虛擬機器和集區</a>

A **工作虛擬機器** (TVM) 是 Azure VM 的批次服務 dedicates 來執行特定工作的應用程式-例如可執行檔 (.exe)，或在批次應用程式的情況下從應用程式映像的一個或多個程式。不同於一般的 Azure VM，您不提供，或直接 ； 管理 TVM相反地，批次服務建立，並管理為 TVMs **集區** 的類似方式設定 Vm，以顯示 [圖 2。

![集區和 TVMs][TVM_pool]

**[圖 2。TVMs 集區**

如果您使用批次的 Api，您可以直接建立集區，或當您指定的工作完成時自動建立一個。如果您使用批次應用程式 API，當您執行已啟用雲端功能的批次應用程式時，將會自動建立集區。


集區的屬性包括：

* A [大小](http://msdn.microsoft.com/library/azure/dn197896.aspx) TVMs 的
* TVM 上執行的作業系統
* TVM 數目上限
* 集區的調整原則 - 根據目前工作負載和資源用量的公式，可動態調整負責處理工作的 TVM 數目
* TVM 上是否啟用防火牆連接埠來允許集區之間的通訊
* TVM 上安裝的憑證 - 例如，驗證對儲存體帳戶的存取權
* TVM 的啟動工作，用於單次作業，例如安裝應用程式或下載給工作所使用的資料

>[AZURE.NOTE]目前，TVM 只能執行 Windows Server 2012 R2、Windows Server 2012 或 Windows Server 2008 R2 SP1 作業系統。

集區只能由建立它的批次帳戶使用。批次帳戶可以有多個集區。

在集區中的每個 TVM 取得指派唯一的名稱及相關聯的 IP 位址。當 TVM 從集區移除時，就會失去對作業系統、其本機檔案、名稱及其 IP 位址所做的變更。當 TVM 離開集區時，其存留期就結束。


### <a id="BKMK_Workitem">工作項目、 工作和工作</a>

A **工作項目** 是指定應用程式集區中的 TVMs 上的執行方式的範本。A **作業** 是排定的工作項目，且可能會出現一次或是再度發生。作業所組成的集合 **工作**。[圖 3] 顯示基本的關聯性。

![工作項目、 工作和工作][job_task]

**[圖 3。工作項目、 工作和工作**

根據您用來開發與批次的 Api，您必須管理的相關工作項目、 工作和工作的更多或較少詳細資料。

* 如果您開發以批次 Api 的應用程式，您需要以程式設計方式定義所有工作項目、 工作和工作，並設定執行工作的 TVM 集區。

* 如果您使用批次應用程式 API 和工具來整合用戶端應用程式，則可以使用元件來自動將作業分割成工作、處理工作，以及將個別工作的結果合併成最終的作業結果。當您提交批次服務的工作負載時，批次的應用程式架構管理工作，並 TVMs 上執行的工作。



### <a id="BKMK_Files">檔案和目錄</a>

檔案是指輸入到作業工作中的一份資料。工作可能沒有、有一個或多個相關聯的輸入檔。相同的檔案也可以用於多個工作，例如，影片轉譯作業中的工作可能有常用的材質和模型。以資料分析作業中的工作而言，檔案可能是一組觀察值或測量值。

每個工作，其中包含它所處理的輸入的資料和它建立的輸出資料存在的工作目錄。當作業執行時，這些目錄和檔案可供其他工作使用。TVM 上的所有工作、檔案和目錄由單一使用者帳戶擁有。

同樣地，根據您使用批次的 Api，您必須管理您的工作和工作的輸入和輸出檔案的相關的更多或較少詳細資料。如果您正在開發以批次 Api，您指定這些相依性和檔案移動明確。在批次應用程式中，架構會為您處理其中大部分的細節。

## 工作項目工作流程
[圖 4] 顯示您如何提交應用程式集區，它屬於分散式處理。這會使用批次應用程式開發介面。

![工作項目工作流程][work_item_workflow]

**[圖 4。工作流程來散發給集區 Vm 的工作項目**

1.	將作業所需的輸入檔 (例如來源資料或影像) 上傳至 Azure 儲存體帳戶。這些檔案必須在儲存體帳戶中，批次服務才能夠存取它們。執行工作時，批次服務會將檔案載入至 TVM。
2.	將相依的二進位檔案上傳至儲存體帳戶。二進位檔案包含工作所執行的程式及相依組件。這些檔案也必須從儲存體中存取，並載入至 TVM。
3.	建立 TVM 集區，並指定集區中的 TVM 大小、它們執行的作業系統，以及其他屬性。工作執行時，系統會從這個集區指派 TVM 給它。
4.	建立工作項目。當您建立工作項目時，就會自動建立作業。工作項目可讓您管理工作的作業。
5.	將工作加入至作業。每個工作會使用您已上傳的程式，以處理您上傳的檔案中的資訊。
6.	執行應用程式，並監視輸出的結果。

## 發行和執行應用程式的工作流程
[圖 5] 中的基本工作流程顯示使用批次應用程式 API 來發佈應用程式，然後將作業提交至批次所啟用的應用程式。

![應用程式發佈工作流程][app_pub_workflow]

**[圖 5。發行和執行應用程式與批次的應用程式的工作流程**

1.	準備 **應用程式映像** -您現有的應用程式可執行檔和任何所需的支援檔案的 zip 檔案。這些可能是您在傳統的伺服器陣列或叢集中執行的相同可執行檔。
2.	建立的 zip 檔案 **定域機組組件** ，將會叫用，並分派至批次服務工作負載。這包含兩個可透過 SDK 取得的元件：

	a.**工作 splitter** – 作業分成可獨立處理的工作。比方說，在動畫案例中，作業分割器可將影片轉譯作業細分成個別的畫面。

	b.**工作處理器** – 叫用應用程式可執行特定工作。例如，在動畫案例中，工作處理器會叫用呈現程式，以呈現工作所指定的單一畫面。

3.	使用批次應用程式 API 或開發人員工具，將前兩個步驟中準備的 zip 檔案上傳到 Azure 儲存體帳戶。這些檔案必須在儲存體帳戶中，批次服務才能夠存取它們。這通常由服務管理員對每個應用程式執行一次。
4.	提供方法將作業提交至 Azure 中啟用的應用程式服務。這可能是您應用程式 UI 中的外掛程式、Web 入口網站，或後端系統中的自動服務。SDK 隨附範例來示範各種選項。

	執行作業：

	a.上傳使用者作業專用的輸入檔 (例如來源資料或影像)。這些檔案必須在儲存體帳戶中，批次服務才能夠存取它們。

	b.連同必要的參數和檔案清單一起提交作業。

	c.使用 API 或批次應用程式入口網站來監視作業進度。

	d.下載輸出。

## 其他資源

* [開始使用 Azure 的批次 Library for.NET](batch-dotnet-get-started.md)
* [Azure 的批次開發程式庫和工具](batch-development-libraries-tools.md)
* [Azure 的批次 REST API 參考](http://go.microsoft.com/fwlink/p/?LinkId=517803)
* [Azure 的批次的應用程式 REST API 參考](http://go.microsoft.com/fwlink/p/?LinkId=517804)

[parallel]: ./media/batch-technical-overview/parallel.png
[TVM_pool]: ./media/batch-technical-overview/TVM_pool.png
[job_task]: ./media/batch-technical-overview/job_task.png
[account_portal]: ./media/batch-technical-overview/account_portal.png
[work_item_workflow]: ./media/batch-technical-overview/work_item_workflow.png
[app_pub_workflow]: ./media/batch-technical-overview/app_pub_workflow.png

<!---HONumber=GIT-SubDir-->