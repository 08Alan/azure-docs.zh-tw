\<properties" pageTitle="Set up a Hybrid Compute Cluster with Microsoft HPC Pack" metaKeywords="" description="Learn how to use Microsoft HPC Pack and Azure to set up a small, hybrid high performance computing (HPC) cluster" metaCanonical="" services="" documentationCenter="" title="Set up a Hybrid Cluster with Microsoft HPC Pack" authors="danlep" solutions="" manager="timlt" editor="mattshel" /\> \<p\>\<tags ms.service="cloud-services" ms.workload="big-compute" ms.tgt\_pltfrm="na" ms.devlang="na" ms.topic="article" ms.date="09/16/2014" ms.author="danlep" /\>\</p\> \<h1 id="set-up-a-hybrid-compute-cluster-with-microsoft-hpc-pack"\>使用 Microsoft HPC Pack 設定混合式運算叢集\</h1\> \<p\>本教學課程說明如何使用 Microsoft HPC Pack 2012 R2 和 Azure 來設定一個小型的混合式高效能運算 (HPC) 叢集。此叢集將包含一個內部部署的前端節點 (一部執行 Windows Server 作業系統和 HPC Pack 的電腦)，和一些您視需要部署在 Azure 雲端服務中作為背景工作角色執行個體的運算節點。然後，您便可以在混合式叢集上執行運算作業。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/hybrid\_cluster\_overview.png" alt="Hybrid HPC cluster" /\>\</p\> \<p\>本教學課程說明一個有時稱為「將量擴大到雲端」的方法，此方法使用 Azure 中可調整的隨選運算資源來執行大量運算的應用程式。\</p\> \<p\>本教學課程假設您先前沒有使用運算叢集或 HPC Pack 的經驗。其只是要協助您快速部署一個示範性質的混合式運算叢集。如需有關在生產環境中以較大規模部署混合式 HPC Pack 叢集的考量和步驟，請參閱\<a href="http://go.microsoft.com/fwlink/p/?LinkID=200493"\>詳細指引\</a\>。\</p\> \<blockquote\> [WACOM.NOTE] Azure 為您的運算資源提供了適合各種不同工作負載的\<a href="http://go.microsoft.com/fwlink/p/?LinkId=389844"\>大小範圍\</a\>。例如，A8 和 A9 執行個體結合了高效能與特定 HPC 應用程式所需的低延遲、高輸送量應用程式網路存取。如需相關資訊，請參閱\<a href="http://go.microsoft.com/fwlink/p/?Linkid=328042"\>關於 A8 和 A9 大量運算執行個體\</a\>。\</p\> \</blockquote\> \<p\>本教學課程將逐步引導您完成下列基本步驟：\</p\> \<ul\> \<li\>\<a href="\#BKMK\_Prereq"\>必要條件\</a\>\</li\> \<li\>\<a href="\#BKMK\_DeployHN"\>在前端節點安裝 HPC Pack\</a\>\</li\> \<li\>\<a href="\#BKMK\_Prpare"\>準備 Azure 訂閱\</a\>\</li\> \<li\>\<a href="\#BKMK\_ConfigHN"\>設定前端節點\</a\>\</li\> \<li\>\<a href="\#BKMK\_worker"\>將 Azure 節點新增至叢集\</a\>\</li\> \<li\>\<a href="\#BKMK\_start"\>啟動 Azure 節點\</a\>\</li\> \<li\>\<a href="\#BKMK\_RunCommand"\>在叢集執行命令\</a\>\</li\> \<li\>\<a href="\#BKMK\_RunJob"\>執行測試工作\</a\>\</li\> \<li\>\<a href="\#BKMK\_stop"\>停止 Azure 節點\</a\>\</li\> \</ul\> \<h2 id="BKMK\_Prereq"\>必要條件\</h2\> \<blockquote\> \<p\>[WACOM.NOTE] 若要完成此教學課程，您必須要有 Azure 帳戶。如果您沒有帳戶，只需要幾分鐘的時間就可以建立免費試用帳戶。如需詳細資訊，請參閱\<a href="http://www.windowsazure.com/zh-tw/develop/php/tutorials/create-a-windows-azure-account/"\>建立 Azure 帳戶\</a\>。\</p\> \</blockquote\> \<p\>此外，針對本教學課程，您還需要下列項目。\</p\> \<ul\> \<li\>\<p\>一部執行 Windows Server 2012 R2 或 Windows Server 2012 版本的內部部署電腦。這部電腦將作為 HPC 叢集的前端節點。如果您目前執行的不是 Windows Server，可以下載並安裝\<a href="http://technet.microsoft.com/evalcenter/dn205286.aspx"\>評估版\</a\>。\</p\> \<ul\> \<li\>\<p\>電腦必須加入 Active Directory 網域。\</p\>\</li\> \<li\>\<p\>確定沒有安裝任何其他伺服器角色或角色服務。\</p\>\</li\> \<li\>\<p\>為了支援 HPC Pack，作業系統必須以下列其中一種語言安裝：英文、日文或中文 (簡體)。\</p\>\</li\> \<li\>\<p\>確認已安裝重要及重大更新。\</p\>\</li\> \</ul\>\</li\> \<li\>\<p\>HPC Pack 2012 R2 的安裝檔，這些檔案是免費提供的。\<a href="http://go.microsoft.com/fwlink/p/?linkid=389557"\>下載\</a\>完整的安裝套件，然後將檔案複製到前端節點電腦或某個網路位置。選擇與安裝的 Windows Server 語言相同語言的安裝檔。\</p\>\</li\> \<li\>\<p\>一個在前端節點具備本機系統管理員權限的網域帳戶。\</p\>\</li\> \<li\>\<p\>使用連接埠 443 從前端節點連線至 Azure 的 TCP 連線。\</p\>\</li\> \</ul\> \<h2 id="BKMK\_DeployHN"\>在前端節點安裝 HPC Pack\</h2\> \<p\>您必須先在將作為叢集前端節點的內部部署 Windows Server 電腦上安裝 Microsoft HPC Pack。\</p\> \<ol\> \<li\>\<p\>使用具備本機系統管理員權限的網域帳戶登入前端節點。\</p\>\</li\> \<li\>\<p\>執行 HPC Pack 安裝檔中的 Setup.exe 來啟動 HPC Pack 安裝精靈。\</p\>\</li\> \<li\>\<p\>在 [HPC Pack 2012 R2 Setup]\<strong\>\</strong\> 畫面上，按一下 [New installation or add new features to an existing installation]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc1.png" alt="HPC Pack 2012 Setup" /\>\</p\>\</li\> \<li\>\<p\>在 [Microsoft Software User Agreement]\<strong\>\</strong\> 頁面上，按 [下一步]\<strong\>\</strong\>。\</p\>\</li\> 在 [選取安裝類型]\<strong\>\</strong\> 頁面上，按一下 [Create a new HPC cluster by creating a head node]\<strong\>\</strong\>，然後按 [下一步]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc2.png" alt="Select Installation Type" /\>\</p\>\</li\> \<li\>\<p\>精靈會執行數項安裝前的測試。如果所有測試皆通過，請在 [安裝規則]\<strong\>\</strong\> 頁面上按 [下一步]\<strong\>\</strong\>。否則，請檢閱系統提供的資訊，並在您的環境中進行任何必要的變更。然後重新執行測試，或是視需要重新啟動安裝精靈。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc3.png" alt="Installation Rules" /\>\</p\>\</li\> \<li\>\<p\>在 [HPC DB 組態]\<strong\>\</strong\> 頁面上，確定已為所有 HPC 資料庫選取 [前端節點]\<strong\>\</strong\>，然後按 [下一步]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc4.png" alt="DB Configuration" /\>\</p\>\</li\> \<li\>\<p\>接受精靈剩餘頁面上的預設選項。在 [安裝必要元件]\<strong\>\</strong\> 頁面上，按一下 [安裝]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc6.png" alt="Install" /\>\</p\>\</li\> \<li\>\<p\>安裝完成之後，請取消核取 [Start HPC Cluster Manager]\<strong\>\</strong\>，然後按一下 [完成]\<strong\>\</strong\>。(您將在稍後的步驟中啟動 HPC 叢集管理員，以完成前端節點的設定。)\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc7.png" alt="Finish" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_Prepare"\>準備 Azure 訂閱\</h2\> \<p\>使用\<a href="https://manage.windowsazure.com"\>管理入口網站\</a\>，為您的 Azure 訂閱執行下列步驟。您必須執行這些步驟，稍後才能從內部部署前端節點部署 Azure 節點。\</p\> \<ul\> \<li\>\<p\>上傳管理憑證 (前端節點與 Azure 服務之間的安全連線所需)\</p\>\</li\> \<li\>\<p\>建立要在其中執行 Azure 節點 (背景工作角色執行個體) 的 Azure 雲端服務\</p\>\</li\> \<li\>\<p\>建立 Azure 儲存體帳戶\</p\> \<blockquote\> \<p\>[WACOM.NOTE] 請一併記下您的 Azure 訂閱識別碼，稍後將需要用到。這項資料可在您的 Azure \<a href="[https://account.windowsazure.com/Subscriptions"\>帳戶資訊\</a\>中找到。\</p\> \</blockquote\>\</li\> \</ul\> \<h3\>上傳預設管理憑證\</h3\> \<p\>HPC Pack 會在前端節點安裝一個自我簽署憑證 (稱為 Default Microsoft HPC Azure Management 憑證)，您可以將它上傳作為 Azure 管理憑證。這個憑證是為了方便進行測試及概念證明部署而提供。\</p\> \<ol\> \<li\>\<p\>從前端節點電腦登入\<a href="https://manage.windowsazure.com"\>管理入口網站\</a\>。\</p\>\</li\> \<li\>\<p\>按一下 [設定]\<strong\>\</strong\>，然後按一下 [管理憑證]\<strong\>\</strong\>。\</p\>\</li\> \<li\>\<p\>在命令列上，按一下 [上傳]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/upload\_cert1.png" alt="Certificate Settings" /\>\</p\>\</li\> \<li\>\<p\>瀏覽前端節點以找出 C:\\Program Files\\Microsoft HPC Pack 2012\\Bin\\hpccert.cer 檔案。然後按一下 [檢查]\<strong\>\</strong\> 按鈕。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/install\_hpc10.png" alt="Upload Certificate" /\>\</p\>\</li\> \</ol\> \<p\>您將在管理憑證清單中看到 [Default HPC Azure Management]\<strong\>\</strong\>。\</p\> \<h3\>建立 Azure 雲端服務\</h3\> \<blockquote\> \<p\>[WACOM.NOTE] 為了獲得最佳效能，請將雲端服務和儲存體帳戶建立在同一個地理區域中。\</p\> \</blockquote\> \<ol\> \<li\>\<p\>在管理入口網站中的命令列上，按一下 [新增]\<strong\>\</strong\>。\</p\>\</li\> \<li\>\<p\>依序按一下 [運算]\<strong\>\</strong\>、[雲端服務]\<strong\>\</strong\> 和 [快速建立]\<strong\>\</strong\>。\</p\>\</li\> \<li\>\<p\>輸入雲端服務的 URL，然後按一下 [建立雲端服務]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/createservice1.png" alt="Create Service" /\>\</p\>\</li\> \</ol\> \<h3\>建立 Azure 儲存體帳戶\</h3\> \<ol\> \<li\>\<p\>在管理入口網站中的命令列上，按一下 [新增]\<strong\>\</strong\>。\</p\>\</li\> \<li\>\<p\>依序按一下 [資料服務]\<strong\>\</strong\>、[儲存體]\<strong\>\</strong\> 和 [快速建立]\<strong\>\</strong\>。\</p\>\</li\> \<li\>\<p\>輸入帳戶的 URL，然後按一下 [建立儲存體帳戶]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/createstorage1.png" alt="Create Storage" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_ConfigHN"\>設定前端節點\</h2\> \<p\>若要使用 HPC 叢集管理員來部署 Azure 節點及提交工作，請先執行一些必要的叢集設定步驟。\</p\> \<ol\> \<li\>\<p\>在前端節點上，啟動 HPC 叢集管理員。如果出現 [Select Head Node]\<strong\>\</strong\> 對話方塊，請按一下 [本機電腦]\<strong\>\</strong\>。[部署待辦事項清單]\<strong\>\</strong\> 會隨即出現。\</p\>\</li\> \<li\>\<p\>在 [Required deployment tasks]\<strong\>\</strong\> 下，按一下 [設定您的網路]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc2.png" alt="Configure Network" /\>\</p\>\</li\> \<li\>\<p\>在 [網路設定精靈] 中，選取 [All nodes only on an enterprise network]\<strong\>\</strong\> (拓撲 5)。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc3.png" alt="Topology 5" /\>\</p\> \<blockquote\> \<p\>[WACOM.NOTE] 這是示範性質的最簡單組態，因為前端節點只需要一張網路介面卡，即可連接到 Active Directory 和網際網路。本教學課程並未涵蓋需要更多網路的叢集案例。\</p\> \</blockquote\>\</li\> \<li\>\<p\>按 [下一步]\<strong\>\</strong\> 以接受精靈剩餘頁面上的預設值。然後，在 [檢閱]\<strong\>\</strong\> 索引標籤上，按一下 [設定]\<strong\>\</strong\> 以完成網路設定。 \<li\>\<p\>在 [部署待辦事項清單]\<strong\>\</strong\> 中，按一下 [提供安裝認證]\<strong\>\</strong\>。\</p\>\</li\> \<li\>\<p\>在 [安裝認證]\<strong\>\</strong\> 對話方塊中，輸入您用來安裝 HPC Pack 之網域帳戶的認證。然後按一下 [確定]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc6.png" alt="Installation Credentials" /\>\</p\> \<blockquote\> \<p\>[WACOM.NOTE]HPC Pack 服務只會將安裝認證用於部署內部部署運算節點。\</p\> \</blockquote\>\</li\> \<li\>\<p\>在 [部署待辦事項清單]\<strong\>\</strong\> 中，按一下 [Configure the naming of new nodes]\<strong\>\</strong\>。\</p\>\</li\> \<li\>\<p\>在 [Specify Node Naming Series]\<strong\>\</strong\> 對話方塊中，接受預設的命名序列，然後按一下 [確定]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc8.png" alt="Node Naming" /\>\</p\> \<blockquote\> \<p\>[WACOM.NOTE]命名序列只會為加入網域的運算節點產生名稱。Azure 節點的名稱是自動產生的。\</p\> \</blockquote\>\</li\> \<li\>\<p\>在 [部署待辦事項清單]\<strong\>\</strong\> 中，按一下 [建立節點範本]\<strong\>\</strong\>。您將使用節點範本將 Azure 節點新增至叢集。\</p\>\</li\> \<li\>\<p\>在 [Create Node Template Wizard] 中，執行下列動作：\</p\> \<p\>a. 在 [選擇節點範本類型]\<strong\>\</strong\> 頁面上，按一下 [Azure 節點範本]\<strong\>\</strong\>，然後按 [下一步]\<strong\>\</strong\>。\</p\>\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc10.png" alt="Node Template" /\>\</p\> \<p\>b. 按 [下一步]\<strong\>\</strong\> 以接受預設範本名稱。\</p\> \<p\>c. 在 [提供訂閱資訊]\<strong\>\</strong\> 頁面上，輸入您的 Azure 訂閱識別碼 (位於您的 Azure \<a href="[https://account.windowsazure.com/Subscriptions"\>帳戶資訊\</a\>中)。然後，在 [管理憑證]\<strong\>\</strong\> 中按一下 [瀏覽]\<strong\>\</strong\>，然後選取 [Default HPC Azure Management]\<strong\>\</strong\>。然後按 [下一步]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc12.png" alt="Node Template" /\>\</p\> \<p\>d. 在 [提供服務資訊]\<strong\>\</strong\> 頁面上，選取您在先前步驟中建立的雲端服務和儲存體帳戶。然後按 [下一步]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/config\_hpc13.png" alt="Node Template" /\>\</p\> \<p\>e. 按 [下一步]\<strong\>\</strong\> 以接受精靈剩餘頁面上的預設值。然後，在 [檢閱]\<strong\>\</strong\> 索引標籤上，按一下 [建立]\<strong\>\</strong\> 以建立節點範本。\</p\> \<blockquote\> \<p\>[WACOM.NOTE]根據預設，Azure 節點範本包含可讓您手動啟動 (佈建) 和停止節點的設定。您也可以設定排程來自動啟動和停止 Azure 節點。\</p\> \</blockquote\>\</li\> \</ol\> \<h2 id="\#BKMK\_worker"\>將 Azure 節點新增至叢集\</h2\> \<p\>您現在可以使用節點範本將 Azure 節點新增至叢集。將節點新增至叢集會儲存其組態資訊，讓您可以隨時在雲端服務中啟動 (佈建) 這些節點作為角色執行個體。在角色執行個體於雲端服務中執行之後，您的訂閱才須為 Azure 節點付費。\</p\> \<p\>在本教學課程中，您將需要新增兩個小型節點。\</p\> \<ol\> \<li\>\<p\>在 HPC 叢集管理員中，於 [節點管理]\<strong\>\</strong\> 的 [動作]\<strong\>\</strong\> 窗格中，按一下 [新增節點]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node1.png" alt="Add Node" /\>\</p\>\</li\> \<li\>\<p\>在 [新增節點精靈] 的 [選取部署方法]\<strong\>\</strong\> 頁面上，按一下 [新增 Azure 節點]\<strong\>\</strong\>，然後按 [下一步]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node1\_1.png" alt="Add Azure Node" /\>\</p\>\</li\> \<li\>\<p\>在 [Specify New Nodes]\<strong\>\</strong\> 頁面上，選取您先前建立的 Azure 節點範本 (預設稱為 [Default AzureNode Template]\<strong\>\</strong\>)。然後，指定 \<strong\>2\</strong\> 個大小為 [小型]\<strong\>\</strong\> 的節點，然後按 [下一步]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node2.png" alt="Specify Nodes" /\>\</p\> \<p\>如需可用虛擬機器大小的詳細資訊，請參閱\<a href="http://msdn.microsoft.com/library/windowsazure/dn197896.aspx"\>Azure 的虛擬機器和雲端服務大小\</a\>。\</p\>\</li\> \<li\>\<p\>在 [Completing the Add Node Wizard]\<strong\>\</strong\> 頁面上，按一下 [完成]\<strong\>\</strong\>。\</p\> \<p\>HPC 叢集管理員中現在會出現兩個 Azure 節點，名為 \<strong\>AzureCN-0001\</strong\> 和 \<strong\>AzureCN-0002\</strong\>。兩者皆處於 [未部署]\<strong\>\</strong\> 狀態。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node3.png" alt="Added Nodes" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_Start"\>啟動 Azure 節點\</h2\> \<p\>當您想要使用 Azure 中的叢集資源時，請使用 HPC 叢集管理員來啟動 (佈建) Azure 節點並讓節點上線。\</p\> \<ol\> \<li\>\<p\>在 HPC 叢集管理員的 [節點管理]\<strong\>\</strong\> 中按一下一或兩個節點，然後在 [動作]\<strong\>\</strong\> 窗格中按一下 [啟動]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node4.png" alt="Start Nodes" /\>\</p\>\</li\> \<li\>\<p\>在 [啟動 Azure 節點]\<strong\>\</strong\> 對話方塊中，按一下 [啟動]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node5.png" alt="Start Nodes" /\>\</p\> \<p\>節點會轉換為 [佈建中]\<strong\>\</strong\> 狀態。您可以檢視佈建記錄檔以追蹤佈建進度。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node6.png" alt="Provision Nodes" /\>\</p\>\</li\> \<li\>\<p\>幾分鐘之後，Azure 節點就會完成佈建並處於 [離線]\<strong\>\</strong\> 狀態。在此狀態下，角色執行個體已在執行，但還沒準備要接受叢集工作。\</p\>\</li\> \<li\>\<p\>若要確認角色執行個體正在執行中，請在\<a href="https://manage.windowsazure.com"\>管理入口網站\</a\>中按一下 [雲端服務]\<strong\>\</strong\>、按一下您的雲端服務名稱，然後按一下 [執行個體]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/view\_instances1.png" alt="Running Instances" /\>\</p\> \<p\>您會看到服務中有兩個執行中的背景工作角色執行個體。HPC Pack 也會自動部署兩個 \<strong\>HpcProxy\</strong\> 執行個體 (中型大小) 以處理前端節點與 Azure 之間的通訊。\</p\>\</li\> \<li\>\<p\>若要讓 Azure 節點上線以執行叢集工作，請選取節點，按一下滑鼠右鍵，然後按一下 [上線]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/add\_node7.png" alt="Offline Nodes" /\>\</p\> \<p\>HPC 叢集管理員會指出節點處於 [線上]\<strong\>\</strong\> 狀態。\</p\>\</li\> \</ol\> \<h2 id="BKMK\_RunCommand"\>在叢集執行命令\</h2\> \<p\>您可以使用 HPC Pack \<strong\>clusrun\</strong\> 命令，在一或多個叢集節點上執行命令或應用程式。其中一個簡單的範例就是使用 \<strong\>clusrun\</strong\> 來取得 Azure 節點的 IP 設定。\</p\> \<ol\> \<li\>\<p\>在前端節點上，開啟命令提示字元。\</p\>\</li\> \<li\>\<p\>輸入以下命令：\</p\> \<p\>\<code data-inline="1"\>clusrun /nodes:azurecn\* ipconfig\</code\>\</p\>\</li\> \<li\>\<p\>您將看到類似以下的輸出。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/clusrun1.png" alt="Clusrun" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_RunJob"\>執行測試工作\</h2\> \<p\>您可以提交一個在混合式叢集上執行的測試工作。這個範例是一個簡單的「參數式掃蕩」工作 (一種本質上平行的運算)，此工作會使用 \<strong\>set /a\</strong\> 命令來執行將自己加上整數的子工作。叢集中的所有節點皆參與完成從 1 到 100 之整數的子工作。\</p\> \<ol\> \<li\>\<p\>在 HPC 叢集管理員中，於 [工作管理]\<strong\>\</strong\> 的 [動作]\<strong\>\</strong\> 窗格中，按一下 [New Parametric Sweep Job]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/test\_job1.png" alt="New Job" /\>\</p\>\</li\> \<li\>\<p\>在 [New Parametric Sweep Job]\<strong\>\</strong\> 對話方塊中，於 [命令列]\<strong\>\</strong\> 中輸入 \<code data-inline="1"\>set /a \*+\*\</code\> (覆寫出現的預設命令行)。保留其餘設定的預設值，然後按一下 [提交]\<strong\>\</strong\> 以提交工作。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/param\_sweep1.png" alt="Parametric Sweep" /\>\</p\>\</li\> \<li\>\<p\>當工作完成時，按兩下 [My Sweep Task]\<strong\>\</strong\> 工作。\</p\>\</li\> \<li\>\<p\>按一下 [檢視工作]\<strong\>\</strong\>，然後按一下子工作以檢視該子工作的計算結果輸出。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/view\_job361.png" alt="Task Results" /\>\</p\>\</li\> \<li\>\<p\>若要查看是哪個節點執行該子工作的計算，請按一下 [Allocated Nodes]\<strong\>\</strong\>。(您的叢集可能會顯示不同的節點名稱。)\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/view\_job362.png" alt="Task Results" /\>\</p\>\</li\> \</ol\> \<h2 id="BKMK\_stop"\>停止 Azure 節點\</h2\> \<p\>試驗完叢集之後，您可以使用 HPC 叢集管理員來停止 Azure 節點，以避免給您的帳戶產生不必要的費用。這樣會停止雲端服務並移除 Azure 角色執行個體。\</p\> \<ol\> \<li\>\<p\>在 HPC 叢集管理員中，於 [節點管理]\<strong\>\</strong\> 中將兩個 Azure 節點都選取。然後，在 [動作]\<strong\>\</strong\> 窗格中，按一下 [停止]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/stop\_node1.png" alt="Stop Nodes" /\>\</p\>\</li\> \<li\>\<p\>在 [停止 Azure 節點]\<strong\>\</strong\> 對話方塊中，按一下 [停止]\<strong\>\</strong\>。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/stop\_node2.png" alt="Stop Nodes" /\>\</p\>\</li\> \<li\>\<p\>節點會轉換為 [停止中]\<strong\>\</strong\> 狀態。幾分鐘之後，HPC 叢集管理員就會顯示這些節點為 [未部署]\<strong\>\</strong\> 狀態。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/stop\_node4.png" alt="Not Deployed Nodes" /\>\</p\>\</li\> \<li\>\<p\>若要確認角色執行個體已未在 Azure 中執行，請在\<a href="https://manage.windowsazure.com"\>管理入口網站\</a\>中按一下 [雲端服務]\<strong\>\</strong\>、按一下您的雲端服務名稱，然後按一下 [執行個體]\<strong\>\</strong\>。將不會有任何執行個體部署於生產環境中。\</p\> \<p\>\<img src="./media/set-up-hybrid-cluster-microsoft-hpc-pack-2012-sp1/view\_instances2.png" alt="No Instances" /\>\</p\> \<p\>本教學課程已完成。\</p\>\</li\> \</ol\> \<h2 id=""\>相關資源\</h2\> \<ul\> \<li\>\<a href="http://go.microsoft.com/fwlink/p/?LinkID=263697"\>HPC Pack 2012 R2 和 HPC Pack 2012\</a\>\</li\> \<li\>\<a href="http://go.microsoft.com/fwlink/p/?LinkID=200493"\>使用 Microsoft HPC Pack 將量擴大到 Azure\</a\>\</li\> \<li\>\<a href="http://go.microsoft.com/fwlink/p/?LinkId=325317"\>將應用程式部署至 Azure 節點\</a\>\</li\> \<li\>\<a href="http://go.microsoft.com/fwlink/p/?linkid=330375"\>Azure VM 中的 Microsoft HPC Pack\</a\>\</li\> \</ul\>
