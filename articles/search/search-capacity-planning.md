<properties
	pageTitle="Azure 搜尋服務中的容量規劃 | Microsoft Azure | 雲端託管搜尋服務"
	description="Azure 搜尋服務中的容量奠基於資料分割及複本，每個都是可計費的搜尋單位。"
	services="search"
	documentationCenter=""
	authors="HeidiSteen"
	manager="mblythe"
	editor=""
    tags="azure-portal"/>

<tags
	ms.service="search"
	ms.devlang="NA"
	ms.workload="search"
	ms.topic="article"
	ms.tgt_pltfrm="na"
	ms.date="02/28/2016"
	ms.author="heidist"/>

# Azure 搜尋服務中的容量規劃

在 Azure 搜尋服務中，您可以以累加方式調整特定運算資源的容量。如果您需要更多的儲存空間和 IO，可以增加資料分割，或是如果要改進查詢和編制索引效能，可以增加複本。

當您在[基本層](http://aka.ms/azuresearchbasic)或[標準層](search-limits-quotas-capacity.md)的其中之一佈建服務時，便會有延展性。

對於這兩個層，購買的容量是用來增加「搜尋單位」(SU)，每個資料分割與複本分別視為一個 SU。

- 「基本」提供每個服務最多 3 個 SU。
- 「標準」提供每個服務最多 36 個 SU。

您必須選擇保持低於該層限制之資料分割與複本的組合。例如，您無法將您的標準服務相應增加至 12 個資料分割和 6 個複本，因為這樣做需要 72 個搜尋單位 (12 x 6)，超過每個服務 36 個搜尋單位的限制。

一般而言，搜尋應用程式通常比資料分割需要更多的複本。如需詳細資訊，請參閱[高可用性](#HA)一節。

**針對特定資源組合計算搜尋單位數：R X P = SU**

計算您需要多少 SU 的公式為複本乘以資料分割。例如，3 個複本乘以 3 個資料分割，會以 9 個搜尋單位計費。

兩個層都以一個複本和一個資料分割開始，視為一個搜尋單位 (SU)。在複本與資料分割都算為一個搜尋單位時，這是唯一的執行個體。每個額外資源，無論是複本或資料分割，都會以其擁有的 SU 來計算。

每個 SU 的成本取決於層。基本層的每個 SU 成本低於標準層。每一層的費率請參閱[定價詳細資料](https://azure.microsoft.com/pricing/details/search/)。

## 基本層：資料分割與複本組合

基本服務可以有 1 個資料分割及最多 3 個複本，上限為 3 個 SU。

<table cellspacing="0" border="1">
<tr><td><b>3 個複本</b></td><td>3 SU</td></tr>
<tr><td><b>2 個複本</b></td><td>2 SU</td></tr>
<tr><td><b>1 個複本</b></td><td>1 SU</td></tr>
<tr><td></td><td><b>1 個資料分割</b></td></tr>
</table>

<a id="chart"></a>
## 標準層：資料分割與複本組合

下表顯示支援複本與資料分割組合所需的搜尋單位數，上限為 36 個搜尋單位 (SU)。

<table cellspacing="0" border="1">
<tr><td><b>12 個複本</b></td><td>12 SU</td><td>24 SU</td><td>36 SU</td><td>N/A</td><td>N/A</td><td>N/A</td></tr>
<tr><td><b>6 個複本</b></td><td>6 SU</td><td>12 SU</td><td>18 SU</td><td>24 SU</td><td>36 SU</td><td>N/A</td></tr>
<tr><td><b>5 個複本</b></td><td>5 SU</td><td>10 SU</td><td>15 SU</td><td>20 SU</td><td>30 SU</td><td>N/A</td></tr>
<tr><td><b>4 個複本</b></td><td>4 SU</td><td>8 SU</td><td>12 SU</td><td>16 SU</td><td>24 SU</td><td>N/A </td></tr>
<tr><td><b>3 個複本</b></td><td>3 SU</td><td>6 SU</td><td>9 SU</td><td>12 SU</td><td>18 SU</td><td>36 SU</td></tr>
<tr><td><b>2 個複本</b></td><td>2 SU</td><td>4 SU</td><td>6 SU</td><td>8 SU</td><td>12 SU</td><td>24 SU</td></tr>
<tr><td><b>1 個複本</b></td><td>1 SU</td><td>2 SU</td><td>3 SU</td><td>4 SU</td><td>6 SU</td><td>12 SU</td></tr>
<tr><td>N/A</td><td><b>1 個資料分割</b></td><td><b>2 個資料分割</b></td><td><b>3 個資料分割</b></td><td><b>4 個資料分割</b></td><td><b>6 個資料分割</b></td><td><b>12 個資料分割</b></td></tr>
</table>

搜尋單位數、定價和容量會在 Azure 網站上詳細說明。請參閱[定價詳細資料](https://azure.microsoft.com/pricing/details/search/)以獲得詳細資訊。

> [AZURE.NOTE] 複本數和資料分割數必須能整除 12 (明確來說就是 1、2、3、4、6、12)。這是因為 Azure 搜尋預先將每個索引分成 12 個分區，這樣就可將其加以散佈在資料分割中。例如，如果您的服務有三個資料分割，而您建立了新的索引，則每個資料分割將會包含 4 個該索引的分區。Azure 搜尋將索引分區的方法是實作細節，有可能在未來版本中變更。雖然現在分區數為 12，但您不應預期未來該數字永遠都會是 12。

<a id="HA"></a>
## 選擇高可用性的資料分割和複本組合

由於相應增加非常快速簡單，我們通常建議您從一個資料分割和一或兩個複本開始，然後於查詢量增長時再相應增加。對於許多部署來說，一個分割區就能提供足夠的儲存體和 IO (每個資料分割為 1 千 5 百萬個文件)。

然而查詢工作負載需依據複本。如果您需要更多的輸送量或高可用性，就可能需要額外複本。

高可用性的一般建議事項為：

- 針對唯讀工作負載 (查詢) 的高可用性為 2 個複本
- 針對讀取/寫入工作負載 (查詢和索引) 的高可用性為 3 或更多個複本

目前沒有任何內建的機制可進行災害復原。因此新增資料分割或複本並不是達成災害復原目標的正確選擇。相反地，您可以考慮在服務等級新增備援。如需因應措施的深入討論，請參閱[這篇論壇文章](https://social.msdn.microsoft.com/Forums/ee108a26-00c5-49f6-b1ff-64c66c8b828a/dr-and-high-availability-for-azure-search?forum=azuresearch)。

> [AZURE.NOTE] 請回想一下，服務等級協定和延展性是標準服務的功能。免費服務會於固定的資源層級提供，而複本和資料分割會由多個訂閱者共用。如果您在開始時使用免費服務而現在想要升級，您必須在標準層級建立新的 Azure 搜尋服務，再將索引和資料重新載入至此新服務中。請參閱[在入口網站中建立 Azure 搜尋服務](search-create-service-portal.md)以獲得服務佈建的指示。

## 關於資料分割和複本

「資料分割」提供儲存體和 IO。單一搜尋服務最多可以有 12 個資料分割。每個資料分割隨附 1 千 5 百萬個文件或 25 GB 儲存體的固定限制，以第一個達到的限制為準。如果您新增資料分割，您的搜尋服務就可以載入更多文件。例如，在您將第二個資料分割加入服務後，服務的單一資料分割就能從原本最多只能儲存 25 GB 的資料，變為可以儲存 50 GB。

「複本」是搜尋引擎的複本。單一搜尋服務最多可以有 6 個複本。您需要至少 2 個複本供讀取 (查詢) 可用性使用，以及至少 3 個複本供讀取/寫入 (查詢、索引) 可用性使用。

每個索引的複本在各自的複本上執行。當您新增複本時，索引的其他複本會回到線上以支援更高的查詢工作負載並負載平衡多個複本上的要求。如果您有多個索引，例如 6 個索引和 3 個複本，則每個複本將會有一份完整的 6 個索引。

請注意，由於執行查詢可能會因為查詢和爭用工作負載的複雜性而有相當程度的出入，因此我們在每秒查詢 (QPS) 上不提供任何硬性的估計。平均來說，一個複本可以提供約 15 QPS 的服務，但您的輸送量會因為查詢的複雜性 (多面向查詢會更複雜) 和網路延遲而稍微較高或較低。此外，請務必了解雖然新增複本會明顯地增加規模和效能，但是最終結果並不會完全地呈線性關係：新增 3 個複本並不保證有 3 倍的輸送量。出現查詢延遲則代表可能需要額外的複本。若要深入了解 QPS，包括針對您的工作負載評估 QPS 的方法，請參閱[管理搜尋服務](search-manage.md)。

<!---HONumber=AcomDC_0302_2016-------->