<properties
   pageTitle="Microsoft Enterprise Cloud Red Teaming"
   description="這篇文章討論 Microsoft 的策略和 Red Teaming 執行，以及對 Microsoft 管理的雲端基礎結構、服務和應用程式進行的即時網站滲透測試。您將了解 Microsoft 如何模擬真實的缺口、進行連續安全性監視以及練習安全性事件回應，以驗證和改善 Microsoft Azure 和 Office 365 的安全性。"
   services="virtual-machines, cloud-services, storage"
   documentationCenter="na"
   authors="YuriDio"
   manager="swadhwa"
   editor=""/>

<tags
   ms.service="azure-security"
   ms.devlang="na"
   ms.topic="get-started-article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="02/17/2016"
   ms.author="yuridio"/>


#Microsoft Enterprise Cloud Red Teaming

Red Teaming 超越了法規遵循認證或其他產業需求，並且為 Microsoft 與我們的客戶提供 Microsoft 雲端服務會持續執行安全性監視、測試和更新的額外保證，以反映客戶和 Microsoft 所面臨之瞬息萬變的威脅。

##簡介

組織可藉由模擬真實攻擊，以及演練持續不斷攻擊的敵人在入侵期間所用的戰術、技巧和程序 (TTP)，針對目前和未來的威脅影響做更充足的準備。不只是設法避免發生安全性事件，設想可能會發生安全性事件也至關重要。從 Red Teaming 與即時網站滲透測試演練取得的資訊，有助於大幅加強防禦、改善回應策略、訓練防禦者，以及提升整個安全性程式的效率。

只把焦點放在缺口預防策略上的組織，無法全面找出安全性偵測與回應的落差。比起採取動作以免在第一時間發生缺口，了解如何才能不只提供保護但也會偵測和回應缺口同樣很重要。組織可以透過生存遊戲 (桌面演練和滲透) 和 Red Teaming (真實攻擊和滲透) 規劃最壞情況的案例，進而開發偵測滲透嘗試所需的功能，並大幅改善與安全性缺口相關聯的回應。

###Microsoft Enterprise Cloud Red Teaming 

本文將概述 Microsoft 如何將 Microsoft 管理的基礎結構、服務和應用程式中運用 Red Teaming (一種即時網站滲透測試形式)。您也會了解 Microsoft 如何模擬實際的安全性缺口、持續監視安全性及練習安全性事件回應，以測試和改善 Microsoft Azure 和 Office 365 (O365) 的安全性。但請注意，在 Red Teaming 和即時網站滲透測試期間，不會故意以一般客戶資料為目標。測試是針對 Microsoft Azure 和 O365 基礎結構與平台，以及 Microsoft 自己的租用戶、應用程式資料。裝載於 Microsoft Azure 或 O365 的客戶租用戶、應用程式和資料決不會成為目標。

###超越預防 

安全性預防策略和技術無法保證可從每一次攻擊安然脫身。以現今的威脅態勢來看，請務必確認缺口已經發生，或者只是發生時間早晚的問題。組織很有可能已遭到入侵，只是尚未發現而已。在此假設下，將會以推動任何組織的基礎結構、人員、程序和技術限制的方式，重新塑造偵測和回應策略。

![NSA 報價](./media/azure-security-enterprise-cloud-red-teaming/azure-security-enterprise-cloud-red-teaming-fig1.png)

根據 Verizon 的 2014 年資料缺口調查報告，在大約 80% 的案例中，受害的組織並未偵測到入侵 (第12 頁，<http://www.verizonenterprise.com/DBIR/2014/>[)](http://www.verizonenterprise.com/DBIR/2014/)。反而是由外部合作對象 (例如客戶、執法機關、第三方服務或外部詐騙偵測機構) 通知他們遭到入侵。除此之外，這些度量僅取自最終偵測到攻擊者的事件！ 不包括到目前為止未偵測到攻擊者的個案。

在下列各節中，我們將討論如何移至 Microsoft 雲端服務 (包括 Microsoft Azure 和 Office 365) 所用的新安全性策略。此安全性策略 (稱為假想缺口) 同時是一種方法和文化的轉換，它改變了設計、工程及作業的基本前提，方法是假設攻擊者已經利用弱點、取得特殊存取權限，以及積極堅守於實際生產服務。

##傳統的安全性方法 

傳統的安全性方法主要著重於預防。預防是一種防禦性策略，目的在消除弱點，從而在安全性缺口發生前緩和下來。在 Microsoft 的線上服務組合 (其中包括 Microsoft Azure、Office 365、CRM Online 等等) 中，這牽涉到利用我們的[*安全性開發*](http://www.microsoft.com/security/sdl/default.aspx) [*營運安全性保證*](http://www.microsoft.com/download/details.aspx?id=40872) (OSA) 方案，持續改善安全性程序。威脅模型分析、靜態程式碼分析和安全性測試很適合用於列舉、降低及管理受攻擊面，但無法消除所有的安全性風險。

預防策略的範例之一就是，Microsoft 如何限制操作員/系統管理員存取有確證的存取需求以及符合資格需求 (例如，已通過背景檢查、符合所有法規遵循和安全性需求、擔任需要存取權的職務/角色等) 的員工。此外，系統管理員不會保有任何長期權限，而是會獲得 Just-In-Time (JIT) 存取權 [1] 和 Just Enough Administration (JEA) [2]。其他範例包括隔離員工電子郵件環境與生產環境，並使用特製化、高度安全強化工作站來執行敏感性作業。

可能的話，以自動化、大量稽核、以工具為基礎的程序取代人為介入。例行功能的範例包括部署、偵錯、收集診斷資料和服務管理。Microsoft Online Services 會持續投入系統安全性和作業自動化，以降低暴露於潛在安全性風險的機會。

從作業技術觀點來看，缺口預防投資雖可限制暴險，但決不可能完全將之排除。因此，Microsoft 安全性方案 (例如 SDL 和 OSA) 和技術的採用和愈臻成熟，仍然是協助預防安全性缺口的重要手段，而每個人都必須接受安全性缺口必然會影響其組織、服務和使用者。

###全新和新興的威脅 

在過去五年或更早之前，業界已更廣泛地討論一個特定的威脅類別。進階持續性威脅 (APT) 一詞專指由國族贊助，嘗試滲透軍隊、國防工業基地和政府網路，其明確目的為洩漏機密資料。現今，APT 一詞廣泛使用於媒體和安全性週期，描述任何似乎特別鎖定個別組織的攻擊，或會認為值得注意的是技術在本質上，無論攻擊實際上屬於進階或持續性。APT 的一般特性包括：

- 複雜的規劃

- 特定/循序目標

- 有效的偵察

- 使用熟練的工具

- 社交工程

現今的敵人有充足的資源和協作機制可供利用。不論敵人的複雜程度，2009 年底到目前為止的安全性事件趨勢都明白指出，事件發生機率增加且風險持續提高。安全性威脅日益複雜並具有針對性質，再加上日益提高的頻率，暗示著安全性缺口遲早會影響所有的使用者和組織。

在目前的威脅態勢中，只著重預防並不足以對付堅決的敵人。此外，利用常見的安全性工具 (例如防毒軟體和入侵偵測系統 (ID))，很難全面捕集或緩和現今的缺口。網路邊緣控制可以將業餘從事者排除在外，但是有天份和動機的攻擊者一定會找到方法來入侵這些虛擬周邊裝置。因此，組織在面臨需要回應缺口的深度與廣度時，常常都準備不足。

隨著 IT 進展和雲端採用，再也無法以透過防火牆進行實體或虛擬管理的網路周邊來定義企業界限。幾乎隨處都可以找到公司資料 (包括敏感性資料和應用程式)：內部部署、在私人資料中心、在雲端、透過第三方，以及各種使用者裝置。上述全部都需要完全不同的安全性策略，以及改變大部分組織所用的安全性方法。

缺口回應一直帶來了許多挑戰，包括識別缺口範圍、及時通知關係人和客戶、調查資料遺失，以及復原遭到入侵的資產。結合了現今的敵人與 IT 進展，缺口回應從來沒有比現在更具挑戰性。因此，不是傳統只著重預防缺口，有效的安全性策略會假設堅決的敵人將會成功破壞所有的防禦。

##假想缺口方法 

目前的威脅態勢需要有效的安全性策略來平衡在預防與偵測和回應方面所投注的心力。透過詳細分析安全性趨勢，Microsoft 開始提倡和強調需要額外投入反應式安全性程序和技術，將重點放在偵測和回應新興的威脅，而不只是預防這些威脅。此外，由於威脅態勢改變和深度的分析，Microsoft 決定修改其安全性策略，除了僅只預防安全性缺口以外，還要有更足夠的能力來處理所發生的缺口 – 此策略認為，主要安全性事件的預測並非事關「如果」，而是事關「何時」。

雖然 Microsoft 的假想缺口作法已施行多年，但大部分的客戶並未察覺強化 Microsoft 雲端背後所進行的工作。假想缺口是一種引導安全性投資、設計決策和作業安全性作法的想法。假想缺口將應用程式、服務、身分識別和網路全都 (內部和外部) 視為不安全並可能遭到入侵，而限制了對上述各項的信任。雖然假設缺口策略並非出自任何 Microsoft 企業或雲端服務的缺口，但不得不承認各個產業的許多組織都遭到侵害，儘管極力試圖預防也是徒然。

雖然避免侵害是任何組織運作不可或缺的一部分，但必須持續測試並增強這些作法，才能有效地解決新興敵人，例如 APT。組織必須先建立並維護穩固、可重複且經過徹底測試的安全性回應程序，才能準備抵抗侵害。

雖然「預防缺口」安全性程序 (例如威脅模型分析、程式碼檢閱和安全性測試) 可能有共同的安全開發週期，但「假想缺口」提供了很多優點，其運用及測量發生缺口時的反應能力來協助考量整體安全性。在 Microsoft，我們為了改善偵測和回應能力，透過安全性回應計劃的持續生存遊戲演練和即時網站滲透測試，著手完成此目標。

![預防缺口和假想缺口](./media/azure-security-enterprise-cloud-red-teaming/azure-security-enterprise-cloud-red-teaming-fig2.png)

*圖 1：預防和假想缺口模型*

假設缺口，安全性重點變成找出和處理落差：

- 偵測攻擊和滲透

- 回應攻擊和滲透

- 從資料外洩、竄改或入侵復原

- 預防未來的攻擊和滲透

「假想缺口」會確認保護、偵測和回應機制均正確執行 - 甚至減少來自「精明攻擊者」(利用合法的資產，例如遭到入侵的帳戶和機器) 的潛在威脅。

雲端和混合式運算模型的本質，讓角色滲透測試在維護安全的作業環境中提高重要性，包括處理缺口的整備程度。因為 Microsoft 雲端的許多層面不在客戶的直接控制之下，Microsoft 不僅要提供保護，也要偵測和回應對基礎結構、平台和服務的攻擊。

因此，Microsoft 會進行生存遊戲演練和一般 Red Teaming 來評估及改善 Microsoft 的「假想缺口」完備性。透過真實攻擊的模型分析以及滲透測試，Microsoft 可以測試其處理攻擊的能力、識別偵測和回應的落差，以及將資源集中於解決這些落差。Microsoft 藉由實行安全性事件回應、執行連續監視、鑑識與修復，致力於開發處理缺口所需的重要功能。

###假想缺口執行 

Microsoft 雲端服務中的「假想缺口」最初是透過生存遊戲來實行，然後透過用來模擬真實攻擊的實際缺口演練 (稱為 Red Team 缺口) 來實行。Red Team 缺口會測試 Microsoft 回應目標式和持續性攻擊的能力，其目標為大幅降低平均偵測時間 (MTTD) [3] 和平均復原時間 (MTTR) [4]。


![假想缺口執行週期](./media/azure-security-enterprise-cloud-red-teaming/azure-security-enterprise-cloud-red-teaming-fig3.png)

*圖 2.假想缺口執行週期*

生存遊戲 (Wargame) 是做為消防演習與真實火災比較的桌面演練。Red Team 演練會產生端對端缺口模擬，儘可能真實地提供安全性事件，有助於準備與處理實際缺口相關的事件。

生存遊戲和 Red Team 缺口提供在實際事件發生前，練習安全性事件回應的機會 - 練習愈多，愈能充分準備好面對真正的事件或缺口。


###生存遊戲 

將資源全部投注於 Red Team 缺口之前，我們已在 Microsoft 從稱為生存遊戲的桌面演練開始著手。生存遊戲演練是類似於 [SDL 威脅模型分析](http://msdn.microsoft.com/magazine/dd148644.aspx)[，](http://msdn.microsoft.com/magazine/dd148644.aspx)[ ](http://msdn.microsoft.com/magazine/dd148644.aspx)不過會針對安全性回應程序和處理攻擊的組織或服務人員進行調整。生存遊戲的目的在於經由 Microsoft 內部不同群體 (從安全部門以至工程和營運部門) 的人員參與，來改善安全性事件回應程序。隨著我們開始並繼續投入愈來愈深入的生存遊戲，我們明白哪些群體或代表錯過了而需要參與其中。

任何可能需要參與實際缺口的個人或群體，已加入成為生存遊戲演練的關鍵人員。代表清單不只納入安全、工程和營運部門，還納入了公司內幾乎所有的群體，例如法務、人力資源、行銷部門，甚至是行政部門。廣泛的群體和個人參與，有助於建立起跨領域和業務單位的必要關聯性，以確保開發完善的缺口回應計劃。在許多情況下，這些演練也可供教育 Microsoft 並讓他們全面察覺與缺口回應相關聯的風險和需求。

生存遊戲演練的主要目標在於確保標準作業程序 (SOP) 的完整性，以及改善偵測和回應。生存遊戲演練有 3 個主要階段：

-   識別攻擊案例

-   模擬攻擊和回應程序

-   事後檢討

識別攻擊案例是從編寫一份要進行模型分析的潛在攻擊清單著手。這些攻擊案例採用許多不同的形式，通常結合了各種的攻擊案例：

-   Denial of service (拒絕服務)

-   惡意程式碼發作

-   遠端執行程式碼

-   客戶資料入侵

-   內部攻擊者

-   服務入侵

案例通常是從已知的常見案例進行選擇及設定優先順序，或藉由檢閱先前報告的安全性事件 (已知會影響 Microsoft、我們的競爭對手，或觀察到普遍發生於業界)。

一旦選擇了攻擊案例，一或多個群體成員 (通常是安全小組成員) 會扮演敵人 (犯罪) 的角色並描述攻擊案例的執行情況。這就是模擬攻擊和回應程序的開頭。

參與生存遊戲的其他成員會扮演防禦的角色，並描述他們會如何偵測或回應攻擊案例 - 參考任何已經存在的標準作業程序 (或找出遺漏或不完整的程序)。因為防禦方會以偵測、調查、緩和或從模擬攻擊復原等步驟回應，所以攻擊方會以反擊方法回應，這些方法通常會使防禦假設失效並迫使防禦者更深入思考如何偵測和回應。

比方說，如果防禦方建議找出並封鎖用於攻擊的攻擊者 IP 位址，攻擊方便會注意到可以輕易變更來源 IP 位址或利用常用的攻擊基礎結構 (例如殭屍網路 (Botnet)) 從數個 IP 位址發動其攻擊。這在桌面演練期間經常是一來一往，以致大幅增加 SOP 和許多安全性投資需求的識別，以及許多珍貴的討論。

生存遊戲雖然非常有幫助，但是對於可以評斷些什麼的確有其限制 – 特別是有關如何處理進行中目標式攻擊和堅決敵人的方面。因此，Microsoft 開始真正地評估和測量對抗堅決的敵人所發出之複雜攻擊的完備性。除了處理實際安全性缺口以外，我們實在想不出其他更好的方法：使用稱為 Red Teaming 的概念來產生實際的安全性缺口。Red Teaming 就是指使用真實的入侵戰術進行攻擊與滲透。Red Teaming 採用生存遊戲的理論層面並讓它成真。

### Red Teaming 

「假想缺口」安全性策略是由兩個 (2) 核心群組執行：Red Team (攻擊者) 和 Blue Team (防禦者) [5]。所謂的 Red Teaming，做法就是針對即時生產基礎結構，使用與真實敵人相同的戰術、技巧和程序 (TTP) 來測試 Microsoft Azure 和 Office 365 系統與作業，而工程或營運團隊不需要預知基礎結構和平台。

這會測試安全性偵測和回應能力，協助以受控管的方式找出生產環境弱點、設定錯誤、無效的假設或其他安全性問題。每個 Red Team 入侵之後，接著 Red Team 與 Blue Team 就會完全揭露以找出落差、處理所發現的狀況，並大幅改善缺口回應。

#### Red Team 

Red Team 是 Microsoft 內部的全職人員所組成，其重點在於入侵 Microsoft 的基礎結構、平台和 Microsoft 自己的租用戶和應用程式。他們是專屬的敵人 (一群有道德的駭客)，負責對線上服務 (Microsoft 基礎結構、平台和應用程式，但並非一般客戶的應用程式和資料) 執行目標式和持續性攻擊。

Red Team 的角色就是使用與敵人的狙殺鍊 (Kill Chain) [6] (如圖 3 所示) 相同的步驟來攻擊與滲透環境：

![入侵階段](./media/azure-security-enterprise-cloud-red-teaming/azure-security-enterprise-cloud-red-teaming-fig4.png)

*圖 3.入侵階段*

因此，研究及瞭解業界事件和威脅整體趨勢，以掌握敵人所用的最新攻擊技巧和工具，是 Red Team 的重要方法之一。身為世界上最常遭受攻擊的網際網路對象之一，Microsoft 線上服務產生了大量有關新興威脅的資料。Red Team 不僅會使用此研究和情報進行模型分析，也會執行與敵人狙殺鍊相關聯的真實戰術。

除了研究調查和模擬分析已知的敵人以外，Red Team 也會使用自訂開發的滲透工具和攻擊方法，開發和衍生出自己的嶄新技巧來入侵 Microsoft Azure 和 Office 365。就如同堅決的敵人一樣，Red Team 會利用新興和混合式威脅，以便執行入侵，而且會在新的障礙或防禦方式出現時改變戰術。

由於有天份和動機的攻擊者會破壞周邊防禦，因此 Red Team 也必須如此。邊緣控制可將業餘從事者排除在外，但持續性的敵人一律可進入其中。進入之後，Red Team 常會取得用來橫向轉換的內部人員權限，以滲透更深入的基礎結構。此外，如同大部分熟練的敵人，Red Team 會建立一個據點，從該據點來維持永續性並可能持續修改其規避偵測的方法。

例如，Red Team 可能會安裝自訂工具 (Bot、遠端控制等)，讓他們得以持續存取遭入侵的資源以及隨時擷取資訊。這類攻擊的技術可讓 Red Team 不只外洩敏感性資料，還可利用這些遭到入侵的資料 (同樣僅限 Microsoft 的資料，而不是客戶的資料)。

由於工作和敏感和重要特質，在 Microsoft Red Team 工作的員工受制於極高的安全性和相容性標準。他們需先經過額外的驗證、背景篩選和訓練，才能夠參與任何攻擊案例。雖然 Red Team 不會故意以客戶資料為目標，但他們會保有的客戶資料存取權

(ATCD) 需求與負責部署、維護及管理 Microsoft Azure 和 Office 365 的服務運作人員相同。此外，Red Team 只會攻擊 Microsoft 管理的基礎結構和平台。對照於攻擊一般客戶資料或應用程式，Red Team 會攻擊 Microsoft 在雲端擁有和操作的租用戶、應用程式和資料。

不過，Red Team 會遵守嚴格的行為準則。Red Team 行為準則的 5 個主要指導原則包括：

1.  不要刻意造成客戶服務等級協定 (SLA) 影響或停機時間。

2.  不要刻意存取或修改客戶資料。

3.  不要刻意執行破壞性動作。

4.  不要減弱已到位的安全性保護。

5.  保護 Red Team 的弱點和其他重要資訊，只與需要知道的人員共用資訊。

此外，Azure 和 O365 Red Team 必須遵循異套書面的教戰規則 (ROE)，其開發目的是為了確保符合行為準則。這些教戰規則是由 Microsoft 的領導階層所簽核。

在每個 Red Team 執行其入侵時，一定要追蹤一些重要的安全性度量：

-   平均入侵時間 (MTTC)

-   平均權限提升時間或 “Pwnage” (MTTP)

平均入侵時間可測量演練開始到 Red Team 已成功入侵資產的時間點。在這個階段，Red Team 通常會在目標環境中建立其初始據點。平均權限提升時間 (或有些敵人偏好稱為 “Pwnage”) 是從演練開始到完全入侵的時間。例如，在以 Active Directory 為基礎的環境中，這是 Red Team 取得網域系統管理員權限及/或入侵網域控制站的時間點。

您可以將 MTTP 視為「遊戲結束」，因為大部分組織都未準備好處理這個層級的入侵。然而，「遊戲結束」案例不是 Red Teaming 所展現的唯一目標或案例，也很值得一提。Red Team 入侵目標可能包括資料竊取、租用戶層級的入侵或拒絕服務等等。此外，MTTC 和 MTTP 度量可以依據演練進行計算，也可以依據目標資產或資料類型進行追蹤，以取得其他資料粒度。

Microsoft Red Team 的角色在於找出目標的安全性控制落差。追蹤 MTTC 和 MTTP 可以讓 Microsoft 決定持續改進的基準。Red Teaming 會利用安全性弱點，同時強調安全性監視和復原落差，以改善事件回應工具和程序 (稍後有詳細說明)。最重要的是，Red Teaming 會產生可證實的影響，透過入侵來證明「假想缺口」的需求。因此，Red Teaming 會列舉業務風險並證明防禦資源、優先順序和投資需求。

#### Blue Team 

Blue Team 是由各安全性事件回應、工程和營運組織的一組專屬安全性回應者或成員所組成。不論其組成為何，他們都是獨立的，會與 Red Team 分開運作。Blue Team 會遵循已建立的安全性程序，並使用最新的工具和技術來偵測及回應攻擊和滲透。

就如同真實世界的攻擊，Blue Team 不知道 Red Team 的攻擊何時或如何發生，或可以使用何種方法。他們的工作就是偵測和回應所有的安全性事件 (不論是 Red Team 攻擊或真實的攻擊)。基於這個理由，Blue Team 會全年全天候待命，而且必須以對待任何其他敵人的相同方式來回應 Red Team 入侵。

當敵人 (如 Red Team) 入侵環境時，Blue Team 必須：

-   收集敵人所留下的證據

-   偵測表示入侵的證據

-   警示適當的工程和營運團隊

-   將警示分類以判斷是否需要進一步調查

-   收集環境中的相關內容以界定缺口的範圍

-   產生補救計劃以遏止或驅逐敵人

-   執行補救計劃並從侵害中復原

下列步驟構成安全性事件回應狙殺鍊，其與敵人的狙殺鍊平行執行，如 圖 4 所示：

![缺口回應階段](./media/azure-security-enterprise-cloud-red-teaming/azure-security-enterprise-cloud-red-teaming-fig5.png)

*圖 4.缺口回應階段*

總而言之，Red Team 的入侵可供 Blue Team 演練偵測和回應端對端真實攻擊的能力。最重要的是，得以在真正的入侵 (來自較不合作的敵人) 之前，練習安全性事件回應。此外，Red Team 入侵讓 Blue Team 能夠增強其局勢意識，這在處理未來缺口 (不論是來勢 Red Team 或其他敵人) 時很有助益。

在整個偵測和回應程序中，Blue Team 會產生可採取行動的情報，並深入瞭解他們嘗試防禦之環境的實際狀況。這通常是透過 Blue Team 在回應 Red Team 攻擊時所執行的資料分析和鑑識，並藉由建立威脅指標 (例如入侵指標) 來完成。

就如同 Red Team 識別安全性案例中落差的方式，Blue Team 會識別其偵測和回應的能力落差。此外，由於 Red Team 會模擬分析真實的攻擊，便可精確地評估 Blue Team 是否能夠應付堅決的敵人。

最後，Red Team 入侵可測量組織的缺口回應整備程度和影響。

Blue Team 通常會評估下列度量：

- 預估偵測時間 (ETTD)

- 預估復原時間 (ETTR)

這些都是「預估時間」的原因是在入侵期間，不論是否/何時發生偵測，Blue Team 都無法 100% 確定 Red Team 何時執行成功的入侵。同樣地，Blue Team 無法完全確定他們是否成功地驅逐 Red Team 並從侵害中完全復原。缺乏 Red Team 存在的證明，並不證明已驅逐敵人並復原侵害。這就安全性事件回應如此有挑戰性的地方 – 就類似拼圖一樣，一次拼一片，不知道最後拼好的圖片全貌，而且完整圖片中可能缺少哪幾片拼圖。

隨著整體威脅態勢的意識提升，以及進一步瞭解其運作環境中的實際情況，Blue Team 可以加強安全性事件回應作法和程序，以增加其處理入侵的整備程度。


#### Red 與Blue 

相對於傳統的滲透測試，Red Team 入侵極力模擬真實世界的威脅，包括固有的「戰爭迷霧」[7]。也就是說，Blue Team 不知道 Red Team 正在做什麼，反之亦然。當 Red Team 入侵資產時，他們可能會觸發安全性警示或事件，但不明白他們早已這麼做。

相反地，Red Team 可能會故意觸發警示，以確認並驗證監視假設或做為敵方戰術。同樣地，Red Team 可能會在演練中發現回應活動，例如密碼重設、受害資產正在復原、已移除持續性機制，或甚至遇到完全驅逐 (雖然最後一項非常罕見)。

就這些而言，Red Team 入侵可以觀察偵測和復原的影響。不過，Red Team 或 Blue Team 均無法單獨精確評估偵測和復原。當 Red Team 和 Blue Team 完全揭露時，只能在演練結束時計算平均偵測時間 (MTTD) 和平均回應時間 (MTTR)。若要完全影響偵測和回應，Red Team 必須：

- 模擬各種 TTP，其源自組織所面對 (或將面對) 之敵人的相關情報

- 在狙殺鍊中運用將演練及驗證偵測和回應的 TTP

- 運用技術複雜度和作業複雜度

- 利用重複作業，確保偵測和回應改進足以對抗堅決的敵人

為了確保演練包含 Blue Team 的起始與參與，Red Team 可能會刻意觸發偵測和回應。一旦 Red Team 完成其所有主要目標，而且尚未發現任何 Blue Team 活動時，通常就會發生這種情形。

觸發偵測和回應的範例之一，就是使用 EICAR 測試檔案[8]刻意在資產 (例如網域控制站 (DC)) 上造成反惡意程式碼掃描。出現非預期安全性警示時 (尤其是在 DC 等重要資產上)，就應該啟動 Blue Team 回應程序。建立安全性事件，可確保已演練端對端入侵 – 從入侵一直到回應。除非 Blue Team 參與，否則可能未完全演練缺口回應。

理想上 Blue Team (一開始) 不知道事件是由實際的攻擊者或內部的 Red Team 觸發。可能的話，Blue Team 應將安全性事件視為真實的事件；至少在可以建立並確認 Red Team 的歸屬前。這種模擬真實入侵的方法是建置真實防禦的最佳方法。


#### Red Team 入侵事後檢討 

在每次 Red Team 入侵結束時，Red Team 和 Blue Team 一起進行事後檢討，以評估缺口和缺口回應。在這個階段，兩個小組會於完全揭露時分享戰術以及所學到的教訓。Red Team 會提供下列詳細資料：何時和如何入侵環境、哪些資產受到 Red Team 入侵和控制、Blue Team 已完全或只是部份成功驅逐 Red Team，以及是已完全從入侵復原。

此外，Blue Team 會提供下列詳細資料：如何和何時偵測到 Red Team (如果有的話)、哪些資產被認為遭到入侵、發現哪些 Red Team 持續性機制、嘗試驅逐 Red Team 並從入侵復原時採取哪些回應步驟。這是 Red Teaming 最獨特且最重要的元素之一 – Red Team 是少數可以並將提供其入侵詳細資料，以及在偵測和回應成功時 (或因此缺少) 提供意見反應的敵人之一。Red Team 和 Blue Team 經驗交流的能力，對於確保已找出所有偵測和回應落差極為重要。

只有在事後檢討期間，進行完全揭露時，才可以計算真正的平均偵測時間 (MTTD) 和平均復原時間 (MTTR) 度量 – 比方說，比較 Red Team MTTC 與 Blue Team ETTD 之間的差異，以便計算實際的 MTTD。在事件發生期間和之後，這些偵測和回應度量可用來列舉與安全性偵測和復原落差 (視為演練的一部分) 相關的商業風險。

其餘的事後檢討大都花在 Red Team 和 Blue Team 合作找出弱點，以及改善防護、偵測和回應的投資需求。對於每次 Red Team 入侵，Red Team 和 Blue Team 會找出對抗未來攻擊所需強化的安全性投資，以及加快偵測和復原。換句話說，增加 MTTC 並減少 MTTD 和 MTTR。

Red Team 和 Blue Team 在事後檢討期間的最後一個步驟是提供詳細的書面報告。這些報告包含 Red Team 和 Blue Team 時間表，演練的商務影響摘要，以及改善缺口偵測和回應所需的詳細弱點、發現和投資清單。

### 安全性原則 

Red Teaming 的主要優點在於彙總專家安全性與道德駭客資源。和任何其他職業一樣，工程師和操作人員有其專精的領域，但不可能包含攻擊與滲透技巧。在 Microsoft，工程師和操作員都十分熟悉 SDL/OSA 和 Common Engineering Criteria (CEC)，但 Red Team 負責生產環境外部限制的安全性測試，否則環境會變得太麻煩而難以處理。

藉由投資 Red Teaming 並以了解、溝通和利用即時網站攻擊期間的最新威脅做為唯一焦點，Microsoft 竭力持續測試及改善其反應能力並遵循安全性原則：

- 抗拒將安全性策略定位於**靜態攻擊案例**或假設敵人僅只來自**一個固定位置**

- 利用**互補安全性控制層級**；效果會累積，並改善防禦功能

- 安全性控制的**數量和散發**比個別效率更重要

- 設法**延遲及回應**，而非**防止**攻擊

## 摘要 

整個產業的公司都面臨殘酷的現實：他們可能一直處於入侵常態中。更糟的是，許多公司不知道他們也遭到入侵，而無憂無慮。現今的威脅態勢需要減少暴險於各種攻擊，包括內部威脅。最迫切的變更就是組織需要大幅減少偵測及從入侵復原的平均時間。

本白皮書強調組織必須更敏銳地處理安全性落差。透過「假想缺口」安全性策略，Microsoft 會持續不斷地追求更廣泛且更深入的安全性投資。所有組織都受惠於採用類似的安全性策略來抵抗新興和不斷演變的威脅。

Microsoft 事先針對入侵進行規劃，以及利用生存遊戲和作用中 Red Team 來模擬攻擊和滲透，進而開發各項功能來管理安全性事件。Red Teaming 藉由公開安全性落差、利用即時弱點，以及提供需要「假想缺口」的具體證明，讓理論案例成真。

具挑戰性的 Blue Teaming 世界會演練在面對攻擊時的偵測和回應能力。藉由執行 Red 和Blue Team 缺口演練，安全性組織可以將重點放在主要攻擊向量、開發因應對策，以及讓他們重要的回應機制更臻完善，準備抵禦堅決的敵人。

Red Teaming 已成為開發和保護 Microsoft 基礎結構、平台和服務的最重要組件之一。Microsoft Azure 和 Office 365 Red Team 會模仿有心機的敵人，讓 Microsoft 能夠驗證和改善安全性、加強防禦，並使其企業雲端安全性方案達到更好的效率。

透過定期即時網站攻擊和滲透，Red Team 入侵可提供練習安全性事件回應的重要方法，以及精確地測量真實攻擊的整備程度和影響。客戶可以確信 Microsoft 在努力提供更安全的雲端服務的過程中，會持續不斷地改善防護、偵測和回應。

## 參考資料和進階閱讀 

下列資源可提供更多有關 Microsoft Azure 和 Office 365 服務的一般資訊，以及主文中所提到的特定項目：

- [Microsoft Azure 首頁](http://azure.microsoft.com) – 關於 Microsoft Azure 的一般資訊和連結

- [Microsoft Office 首頁](http://products.office.com) – 關於 Microsoft Office 的一般資訊和連結

- [Microsoft Azure 信任中心](https://www.microsoft.com/TrustCenter/CloudServices/Azure)

- [Microsoft Office 365 信任中心](https://www.microsoft.com/TrustCenter/CloudServices/Office-365)

- [Microsoft 安全性回應中心](http://www.microsoft.com/security/msrc/default.aspx)

- Microsoft Azure 或 Office 365 (可以向 [**http://www.microsoft.com/security/msrc/default.aspx*](http://www.microsoft.com/security/msrc/default.aspx)[ ](http://www.microsoft.com/security/msrc/default.aspx) 回報或透過寄送電子郵件至 **secure@microsoft.com*

- [與 Mark Russinovich 暢談 Microsoft Azure 和安全性 - 滲透測試更新](http://blogs.technet.com/b/matthewms/archive/2013/07/02/an-interview-with-mark-russinovich-on-windows-azure-amp-security-update-on-penetration-testing.aspx)

- [Red 與Blue - Microsoft Azure 和 O365 的內部安全性滲透測試](http://azure.microsoft.com/documentation/videos/red-vs-blue-internal-security-penetration-testing-of-microsoft-azure/)



## 附錄 

### Red Teaming 與滲透測試之間的差異 

標準滲透測試技術會使用常用的工具來嘗試入侵，但很少會完全發揮精明敵人的能力。

傳統的滲透測試只代表某個點時間，而後結束，不需像真正的敵人一樣對環境和事件施壓。Red Teaming 會持續進行，並不會在測試完成時停止。Red Teaming 會尋找其他滲透測試方法常會錯誤的事項 (彙總於下面的表 1 中)：

**傳統的滲透測試 RED TEAMING**

| | 傳統的滲透測試 | Red Teaming |
|---------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **持續性** | 在成功入侵環境時停止 | 建立持續性機制，以維護存取權及評估缺口復原完整性 |
| **工具** | 只會使用當時可用的工具，然後必須等到您進行下一個測試週期 | 不斷研究新的入侵和弱點，並且在發現新的入侵和弱點時立即使用新工具實作攻擊 |
| **缺口後的活動** | 屬於白帽 (White Hat) 駭客 (他們只會試著入侵，如果入侵成功，他們通常不會有進一步的動作) | 利用缺口來外洩和入侵關鍵資料，以便發動進一步的攻擊 |
| **逸出和規避** | 靜態測試可能不會嘗試規避偵測，並且會在發現偵測時停止 | 動態測試會嘗試規避偵測 |
| **精明的敵人** | 偏好對已知到位的安全性系統施壓 (因為可能完全了解 IT 系統)、測試這些系統是否部署正確，或使用已知的入侵攻擊 | 探查已經和尚未部署哪些系統來找出弱點；利用內部知識和自訂工具來攻擊系統，包括自訂和先前未知入侵的開發 |
| **即時網站** | 幾乎不會攻擊整個生產系統；最常用來測試預先部署的系統 | 攻擊生產系統；攻擊堆疊的所有層級 |
| **動機** | 提出有關環境的各種假設，但不會未經告知就進行測試 | 不會提出任何假設；到處嘗試入侵；必要時會轉換和變更戰術 |
| **結果** | 顯示已進行哪些測試和結果 (成功 / 失敗) | 測量並準確地評估 MTTC、MTTP、MTTD 和 MTTR。對於侵害環境的時間和方式、受到入侵的資產，以及偵測和回應是否成功，提供詳細的證明。 |


**表 1：摘要說明傳統的滲透測試與 Red Teaming 之間的差異**


##為何攻擊生產環境？ 

測試和預先生產必定不符合生產環境。在部署、進行中服務作業期間所做的變更，以及生產環境客戶的使用差異，全都會造成狀態的變動。這項變動理當存在的理由，是因為生產環境面臨了預期負載、可接受的停機時間，以及安全性、相容性、法規和合約需求等方面的不同需求。

Red Teaming 透過即時站台滲透測試以真正的系統做為目標，而不只是在實驗室中以假定的工作負載攻擊開發/測試環境，或甚至以模擬資料攻擊真正的元件。這是 Red Teaming 不同於傳統安全性策略的主要方式之一：真正的伺服器、真正的租用戶和真正的資料。生產環境的即時網站滲透測試會對於與缺口相關的客戶和商務影響，提供更可靠且精確的測量。

即時網站滲透生產環境可提供額外的好處。它會試驗偵測和回應的防禦能力。真實的攻擊測試可測試生產環境所部署的保護強度、偵測和回應能力 (或不足之處)。它會迫使這些投資接受生產環境遭受攻擊、目前可能處於被入侵狀態的事實，並且代表一項強制功能，可供安全性事件回應定期練習用於處理目標式攻擊和持續存在之敵人的方法。

##執行 Red Team 

採用「假想缺口」不一定需要投入自己的 Red Team 資源。只要改變基礎結構和應用程式安全性測試和部署的方法，即可實現許多優點。例如，了解資料缺口的存留可以遠超過初期入侵，可協助您設計相關保護措施來保護資訊和重要資產 (甚至在發生侵害時)。

不過，Red Teaming 可有效測試您的安全性措施和程序的真實性、喚起目前態勢的意識，以及讓工程師、營運部門、安全性回應者和管理階層能隨時察覺新興的威脅。若要決定您的投資優先順序，請考慮下列各項：

-   **預防缺口與假想缺口**：兩者無法互相取代。「預防缺口」是用以防禦攻擊的安全性功能的重要實作。「假想缺口」遠遠超越這些保護功能，會考慮到侵害之前、期間和之後的偵測和回應。

-   **辨識珍寶**：使用「假想缺口」方法來設定投資的優先順序。什麼是企業最重要的資料？ 資料會儲存在何處？ 什麼是經營企業最重要的資產？

-   **識別相關演練**會根據缺口趨勢和您的環境適用的攻擊者 TTP，設定安全性演練的優先順序。

-   **全心投入**：特別是經營管理層級，並確保合法登出。此外，貴公司的各個工作群體 / 部門應該要留意和接受您所從事的工作；在可能造成非預期的服務中斷和客戶滿意度問題之前，對未曾遭受攻擊的營運部門發動攻擊。


一旦建立推行 Red Teaming 的計劃後，您就必須保護您的營運部門：

-   **人員** — 確定您在「假想缺口」的兩邊 (Red 和 Blue Team) 有足夠的專家資源。Blue Team 應將所有的安全性事件 (包括 Red Team 侵害) 視為真實的事件。請考慮全職資源與外包資源的取捨，包括在 Red Teaming 期間所產生和遭受侵害之智慧財產的安全性。如果您要讓第三方參與其中，請*檢查其領域*、負債和信譽。

-   **篩選** — 小組成員除了具備必要的技術技能，他們還必須值得信賴；徹底調查有潛力的員工，包括深入背景檢查。

-   **訓練** — 如果您雇用了全職員工，他們應接受標準的道德、安全性、隱私權和法規遵循實務訓練，並且符合您的企業或產業的獨特需求 (外部機構應獲得認證，以確保提供定期訓練活動)。

-   **稽核** — 在 Red Team 演練之前和期間，一定要適當地監控、記錄和稽核 Red Team 的活動。假使 Red Team 因為演練所造成的損害而遭受指責，這就可當作「赦免卡」使用；有助於確保 Red Team 遵循嚴格的行為準則及遵守教戰規則。此外，這些記錄檔和稽核記錄通常有助於計算 MTTC、MTTD 和 MTTR，以及提供詳細的演練後報告。

-   **作業安全性** — Red Team 成員對於其 TTP、工具、安全性發現、報告、入侵、後門程式和其他資產，落實嚴格的作業安全性。倘若攻擊者取得 Red Team 的資產存取權，他們就能夠對已知的弱點迅速重現並重新執行攻擊，並帶來毀滅性的影響。

##其他資訊

進行企業規模的滲透測試時，需要組織內多方的參與。本文件涵蓋程序性指引，因此適合於負責針對安全性風險評估環境、系統和程序的人員使用。請注意，文中提供的詳細資料是 Microsoft Azure 和 Office 365 的安全小組如何進行 Red Teaming 和即時網站滲透測試的概觀，而不是客戶應如何攻擊 Microsoft 的雲端基礎結構、平台或服務的指示。

雖然 Microsoft 會進行定期滲透測試來改善雲端安全性控制和程序，但我們了解安全性評估對客戶的應用程式開發和部署活動而言也很重要。因此，我們建立了一套原則，讓客戶可以為他們的應用程式 (例如在 Microsoft Azure 中託管的應用程式) 進行經過授權的滲透測試。

由於這類滲透測試很難與實際的攻擊區分，凡要執行測試的客戶請務必先獲得 Microsoft Azure 客戶支援的核准。執行客戶滲透測試時，請務必遵循 Microsoft 的條款和條件。請至少在 7 天之前提交執行滲透測試的要求通知。如需詳細資訊，請參閱 [Microsoft 信任中心]https://www.microsoft.com/TrustCenter/CloudServices/Azure)。

## 參考

[1] Just-in-Time (JIT) 存取權和提升權限 – 根據需要和僅在有需要時的原則授與的提升權限。實作方式通常為在授與存取權前需要經過一或多次核准。

[2] Just Enough Administration (JEA) – 為了協助保護系統而設計的解決方案，其允許不具系統管理員權限的特定使用者執行系統管理工作，然後再稽核這些使用者執行的所有動作。如需詳細資訊，請參閱 [TechNet 資源庫上的 Just Enough Administration 文章](https://gallery.technet.microsoft.com/Just-Enough-Administration-6b5ad370)

[3] 在安全性缺口的內容中，MTTD 是指偵測缺口所需的時間量。

[4] MTTR 是指從偵測到缺口到復原所需的時間長度。

[5] Microsoft Azure 和 Office 365 人員會劃分為全職的 Red Team 和 Blue Team。

[6] 如需詳細資訊，請參閱 Lockheed Martin 的 [“Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill Chains”](http://www.lockheedmartin.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driven-Defense.pdf)。

[7] 戰爭迷霧 – 用來描述參與者對於自己的能力、敵人能力和敵人意圖所體驗到的局勢意識不確定性。

[8] EICAR 測試檔案 – 也稱為 EICAR 標準防毒測試檔案 - 是由歐洲電腦防毒研究協會 (EICAR) 和電腦防毒研究組織 (CARO) 所開發的電腦檔案，用於測試反惡意程式碼程式的回應。此測試檔案不會使用真正的惡意程式碼 (這可能造成實際傷害)，可讓您不需使用實際的電腦病毒，即可測試反惡意程式碼軟體。


*(c) 2014 Microsoft Corporation.著作權所有，並保留一切權利。這份文件依「現狀」提供。 本文件中提供的資訊與畫面 (包括 URL 及其他網際網路網站參考資料) 如有變更，恕不另行通知。您必須自行承擔使用風險。有些範例僅供說明之用，純屬虛構。並未影射或關聯任何真實的人、事、物。本文件未提供給您任何 Microsoft 產品中任何智慧財產的任何法定權利。您可以複製並使用這份文件，供內部參考之用。*

<!---HONumber=AcomDC_0218_2016-->