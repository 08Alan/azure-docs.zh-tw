---
title: 在 Azure Cosmos DB 中各種一致性層級的可用性和效能權衡取捨
description: 在 Azure Cosmos DB 中各種一致性層級的可用性和效能權衡取捨。
author: rimman
ms.service: cosmos-db
ms.topic: conceptual
ms.date: 04/08/2019
ms.author: rimman
ms.reviewer: sngun
ms.openlocfilehash: a76e277bf56861bcaefb5bf7f8b3b3bc03ad1164
ms.sourcegitcommit: 3102f886aa962842303c8753fe8fa5324a52834a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "60894023"
---
# <a name="consistency-availability-and-performance-tradeoffs"></a>一致性、可用性與效能權衡取捨 

仰賴複寫功能來獲得高可用性和 (或) 低延遲特性的分散式資料庫必須做出權衡取捨。 所要權衡取捨的項目是讀取一致性與可用性、延遲和輸送量。

Azure Cosmos DB 會針對資料一致性提供選項頻譜。 這個方法所包含的選項比強式和最終一致性這兩個極端方法所含的選項還多。 一致性頻譜上有五個定義完善的模型可供您選擇。 最強到最弱的模型分別為：

- *強式*
- *限定過期*
- *工作階段*
- *一致前置詞*
- *最終*

每个模型均提供可用性和性能权衡，并由综合 SLA 提供支持。

## <a name="consistency-levels-and-latency"></a>一致性層級和延遲

一律保證適用於所有一致性層級的讀取延遲都會在第 99 個百分位數小於 10 毫秒。 這個讀取延遲由 SLA 所支援。 平均讀取延遲 (在第 50 個百分位數) 通常是 2 毫秒或更少。 橫跨數個區域且設定了強式一致性的 Azure Cosmos 帳戶是此保證的例外狀況。

所有一致性级别的写入延迟始终保证在第 99 百分位小于 10 毫秒。 這個寫入延遲由 SLA 所支援。 平均寫入延遲 (在第 50 個百分位數) 通常是 5 毫秒或更少。

对于配置了强一致性（与多个区域一致）的 Azure Cosmos 帐户，两个最远区域之间的写入延迟保证在第 99 百分位小于往返时间 (RTT) 的两倍加上 10 毫秒。

確切的 RTT 延遲是一個光速距離的函式和 Azure 網路拓撲。 Azure 網路不會針對任兩個 Azure 區域之間的 RTT 提供任何延遲 SLA。 您 Azure Cosmos 帳戶的複寫延遲會顯示在 Azure 入口網站中。 可以使用 Azure 门户（转到“指标”边栏选项卡）监视与 Azure Cosmos 帐户关联的各个区域之间的复制延迟。

## <a name="consistency-levels-and-throughput"></a>一致性層級和輸送量

- 相較於強式和限定過期，工作階段、一致前置詞和最終一致性層級可針對相同數量的要求單位提供大約兩倍的讀取輸送量。

- 針對指定類型的寫入作業 (例如，插入、取代、更新插入和刪除)，對於要求單位的寫入輸送量會與所有一致性層級完全相同。

## <a id="rto"></a>一致性層級和資料持久性

在全域分散式資料庫環境內，當發生全區域中斷情況時，一致性層級與資料持久性之間具有直接關聯性。 當您開發商務持續性計劃時，您必須了解應用程式在干擾性事件之後完全復原所需的最大可接受時間。 应用程序完全恢复所需的时间称为**恢复时间目标** (**RTO**)。 您也必須了解在干擾性事件之後復原時，應用程式可忍受遺失的最近資料更新最大期間。 可以承受更新丢失的时限称为**恢复点目标** (**RPO**)。

下表定义了当发生区域范围的服务中断时，一致性模型与数据持续性之间的关系。 请务必注意，在分布式系统中，由于 CAP 定理的存在，即使一致性较高，也不可能存在 RPO 和 RTO 为零的分布式数据库。 若要详细了解原因，请参阅 [Azure Cosmos DB 中的一致性级别](consistency-levels.md)。

|**區域**|**複寫模式**|**一致性層級**|**RPO**|**RTO**|
|---------|---------|---------|---------|---------|
|1|單一或多重主機|任何一致性層級|< 240 分鐘|< 1 週|
|> 1|單一主機|工作階段、開頭一致、最終|< 15 分鐘|< 15 分鐘|
|> 1|單一主機|限定過期|*K* & *T*|< 15 分鐘|
|> 1|多重主機|工作階段、開頭一致、最終|< 15 分鐘|0|
|> 1|多重主機|限定過期|*K* & *T*|0|
|> 1|單一或多重主機|強式|0|< 15 分鐘|

*K* = 某个项的“K”版本（即更新）的数目。

*T* = 自上次更新以来的时间间隔“T”。

## <a name="next-steps"></a>後續步驟

深入了解分散式系統中的全域散發和一般一致性權衡取捨。 請參閱下列文章：

- [新式分散式資料庫系統設計的一致性權衡取捨](https://www.computer.org/csdl/magazine/co/2012/02/mco2012020037/13rRUxjyX7k) \(英文\)
- [高可用性](high-availability.md)
- [Azure Cosmos DB SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db/v1_2/)
